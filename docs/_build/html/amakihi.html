<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>amakihi package &mdash; amakihi 0.1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="amakihi" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> amakihi
          </a>
              <div class="version">
                0.1.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="readme.html">amakihi</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">amakihi</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">amakihi package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-amakihi.amakihi">amakihi.amakihi module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-amakihi.astroalign_mod">amakihi.astroalign_mod module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-amakihi.background">amakihi.background module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-amakihi.crop">amakihi.crop module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-amakihi.crossmatch">amakihi.crossmatch module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-amakihi.ePSF">amakihi.ePSF module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-amakihi.imalign">amakihi.imalign module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-amakihi.masking">amakihi.masking module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-amakihi.plotting">amakihi.plotting module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-amakihi.query_2MASS">amakihi.query_2MASS module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-amakihi.query_CFIS">amakihi.query_CFIS module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-amakihi.query_DECaLS">amakihi.query_DECaLS module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-amakihi.query_PS1">amakihi.query_PS1 module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-amakihi.rb_dataset_utils">amakihi.rb_dataset_utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-amakihi.rb_model_utils">amakihi.rb_model_utils module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-amakihi.templates">amakihi.templates module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-amakihi.transient">amakihi.transient module</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-amakihi">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">amakihi</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">amakihi</a></li>
      <li class="breadcrumb-item active">amakihi package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/amakihi.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="amakihi-package">
<h1>amakihi package<a class="headerlink" href="#amakihi-package" title="Permalink to this heading"></a></h1>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this heading"></a></h2>
</section>
<section id="module-amakihi.amakihi">
<span id="amakihi-amakihi-module"></span><h2>amakihi.amakihi module<a class="headerlink" href="#module-amakihi.amakihi" title="Permalink to this heading"></a></h2>
<p>Big module which handles all of the actual image differencing.</p>
<p><strong>References:</strong></p>
<dl class="simple">
<dt>[1] Alard, C., &amp; Lupton, R. H. 1998, ApJ, 503, 325</dt><dd><p><a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1998ApJ...503..325A/abstract">https://ui.adsabs.harvard.edu/abs/1998ApJ…503..325A/abstract</a></p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="amakihi.amakihi.get_substamps">
<span class="sig-prename descclassname"><span class="pre">amakihi.amakihi.</span></span><span class="sig-name descname"><span class="pre">get_substamps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">science_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sci_mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp_mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etamax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">areamax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sepmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'mean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.amakihi.get_substamps" title="Permalink to this definition"></a></dt>
<dd><p>Get and write a substamps file containing the coordinates of good
sources for hotpants which are present in both the science and template
images.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>science_file, template_file</strong> (<em>str</em>) – Science and template images fits files</p></li>
<li><p><strong>sci_mask_file</strong> (<em>str, optional</em>) – Fits files for bad pixel masks for the science and template images
(default None for both)</p></li>
<li><p><strong>thresh_sigma</strong> (<em>float, optional</em>) – Sigma to use in setting the threshold for source detection via image
segmentation (default 3.0)</p></li>
<li><p><strong>etamax</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed elongation for an isophote to be considered a good
source for hotpants (default 2.0)</p></li>
<li><p><strong>areamax</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed pixel area for an isophote to be considered a good
source for hotpants (default 400.0)</p></li>
<li><p><strong>sepmax</strong> (<em>float, optional</em>) – <em>Maximum</em> on-sky separation (arcsec) of sources between the science and
template images to be designated as a source present in both (default
5.0)</p></li>
<li><p><strong>mode</strong> (<em>{“mean”, “science”, “template”}, optional</em>) – Coordinate system to use for the output (xi, yi) pairs (default “mean”,
see notes for details)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output ascii text file (default
<cite>science_file.replace(“.fits”, “_substamps.txt”)</cite>)</p></li>
<li><p><strong>verbose</strong> (<em>bool, optional</em>) – Whether to be verbose (default False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple containing the tables of source coordinates (“xcentroid”,
“ycentroid”) for the science and reference images</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple of astropy.table.Table objects</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For both the science and template image, finds sources via image
segmentation and selects those which are not overly elongated (to filter
out galaxies) or overly large (to filter out saturated stars). Then
compares the science and template images, finds sources in common, and
writes these to an ascii text file in the form</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s1">&#39;x1 y1&#39;</span>
<span class="s1">&#39;x2 y2&#39;</span>
<span class="s1">&#39;x3 y3&#39;</span>
<span class="o">...</span>
</pre></div>
</div>
<p>Where the exact coordinates are determined by the setting for <cite>mode</cite>. If
<cite>mode == “mean”</cite>, the coordinates will be the average of the science and
template image; if <cite>mode == “science”</cite> or <cite>mode == “template”</cite>, the
coordinates will be those of the science or template image, respectively.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.amakihi.param_estimate">
<span class="sig-prename descclassname"><span class="pre">amakihi.amakihi.</span></span><span class="sig-name descname"><span class="pre">param_estimate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">science_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sci_epsf_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp_epsf_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixelmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etamax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">areamax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">35</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.amakihi.param_estimate" title="Permalink to this definition"></a></dt>
<dd><p>Get a rough estimate for the parameters of the Gaussian basis kernel
which should be used by <cite>hotpants</cite> given some input science and template
images, and whether to convolve the science or template image during
differencing. <strong>However, see notes</strong>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>science_file, template_file</strong> (<em>str</em>) – Science and template images fits files</p></li>
<li><p><strong>mask_file</strong> (<em>str, optional</em>) – Bad pixel mask fits file (default None)</p></li>
<li><p><strong>sci_epsf_file</strong> (<em>str, optional</em>) – Fits file containing the science and template images’ ePSFs,
respectively (default None for both, in which case ePSF will be
estimated here with <cite>build_ePSF()</cite>)</p></li>
<li><p><strong>thresh_sigma</strong> (<em>float, optional</em>) – Sigma threshold for source detection with image segmentation (default
3.0)</p></li>
<li><p><strong>pixelmin</strong> (<em>float, optional</em>) – <em>Minimum</em> pixel area of an isophote to be considered a good source for
building the ePSF (default 20; passed to <cite>build_ePSF_imsegm()</cite> only
if needed)</p></li>
<li><p><strong>etamax</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed elongation for an isophote to be considered a good
source for building the ePSF (default 1.4; passed to
<cite>build_ePSF_imsegm()</cite> only if needed)</p></li>
<li><p><strong>areamax</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed area (in square pixels) for an isophote to be
considered a good source for building the ePSF (default 400.0, passed
to <cite>build_ePSF_imsegm()</cite> only if needed)</p></li>
<li><p><strong>cutout</strong> (<em>int, optional</em>) – Cutout size around each star in pixels (default 35; must be <strong>odd</strong>;
rounded <strong>down</strong> if even; passed to <cite>build_ePSF_imsegm()</cite> only if
needed)</p></li>
<li><p><strong>verbose</strong> (<em>bool, optional</em>) – Whether to be verbose (default True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>convolve</strong> (<em>{“t”, “i”}</em>) – String indicating whether to convolve the template (t) or science
image (i) during image differencing with <cite>hotpants</cite></p></li>
<li><p><strong>gaussian</strong> (<em>dict</em>) – Dictionary containing the parameters of the Gaussian basis kernel
to use during image differencing with <cite>hotpants</cite></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><strong>Not stable right now.</strong> Messes up when science and reference have very
similar PSFs (which is often the case and in fact what we want).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.amakihi.hotpants">
<span class="sig-prename descclassname"><span class="pre">amakihi.amakihi.</span></span><span class="sig-name descname"><span class="pre">hotpants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">science_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sci_mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmp_mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">substamps_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_estimate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">iu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">il</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tl</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lsigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hsigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gd</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ng</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rkernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nrx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsx</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rss</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ssig</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'i'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bgo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ko</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">conv_write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kern_write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise_scale_write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">convout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noiseout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noisescaleout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">log</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotname</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_large</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_small</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixelmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etamax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">areamax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.amakihi.hotpants" title="Permalink to this definition"></a></dt>
<dd><p>Wrapper for the hotpants image differencing software <a class="footnote-reference brackets" href="#id3" id="id1">1</a>, adapted
primarily for use with the Canada-France-Hawaii Telescope (CFHT) MegaCam
instrument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>science_file, template_file</strong> (<em>str</em>) – Science image and template image fits files</p></li>
<li><p><strong>sci_mask_file, tmp_mask_file</strong> (<em>str, optional</em>) – Masks of pixels to ignore in the science and template images (fits
files; default None)</p></li>
<li><p><strong>substamps_file</strong> (<em>str, optional</em>) – Text file containing the locations of substamps (default None)</p></li>
<li><p><strong>param_estimate</strong> (<em>bool, optional</em>) – Whether to try and estimate the optimal parameters of the Gaussian
basis kernel and whether to convolve the template or science image
(default False; <strong>recommended to keep it this way</strong> - not reliable)</p></li>
<li><p><strong>iu, tu, il, tl</strong> (<em>float, optional</em>) – Upper (u) and lower (l) ADU limits for the science image (i) and
template image (t) (default None, in which case these limits are set
according to args <cite>lsigma</cite>, <cite>hsigma</cite>)</p></li>
<li><p><strong>lsigma, hsigma</strong> (<em>float, optional</em>) – Number of standard deviations away from the background at which to
place the lower and upper ADU limits (default 5.0, but only used if
<cite>tu</cite>, <cite>tl</cite>, <cite>iu</cite>, <cite>il</cite> are not given)</p></li>
<li><p><strong>gd</strong> (<em>str, optional</em>) – String of form “xmin xmax ymin ymax” indicating the region in which
pixels are good (e.g. “150 1000 200 800” to trim the edges of some
1000x1000 image; default None –&gt; use whole image)</p></li>
<li><p><strong>ig, ir, tg, tr</strong> (<em>float, optional</em>) – Gain (g) and readnoise (r) for the science image (i) and template (t)
(default None, in which case values are extracted from headers if
present; if not present, default is <cite>ig = tg = 1</cite>, <cite>ir = tr = 0</cite>)</p></li>
<li><p><strong>ng</strong> (<em>str, optional</em>) – String of form “ngauss degree0 sigma0 … degreeN sigmaN”, where
N=ngauss-1, “ngauss” is the number of Gaussians in the basis kernel,
degreej is the degree of the polynomial attached to the jth Gaussian,
and sigmaj is the width of the jth Gaussian (default
“3 6.0 0.7 4.0 1.5 2.0 3.0”, which is a mixture of 3 Gaussians with
widths 0.7, 1.5, 3.0 respectively and polynomials of order 6, 4, 2,
respectively). <strong>This is the most important setting.</strong></p></li>
<li><p><strong>rkernel</strong> (<em>float, optional</em>) – FWHM of the convolution kernel (default, 10.0)</p></li>
<li><p><strong>nrx, nry</strong> (<em>int, optional</em>) – Number of regions in the x and y directions, respectively (defaul 1 for
both)</p></li>
<li><p><strong>nsx, nsy</strong> (<em>int, optional</em>) – Number of stamps in each region in the x and y directions, respectively
(default 10 for both)</p></li>
<li><p><strong>nss</strong> (<em>int, optional</em>) – Number of centroids (i.e. sources) to extract within each stamp
(default 3)</p></li>
<li><p><strong>rss</strong> (<em>float, optional</em>) – Half-width of the substamp for centroid extraction (default
<cite>2.5*rkernel</cite>, which is 25.0 for default <cite>rkernel</cite>)</p></li>
<li><p><strong>ssig</strong> (<em>float, optional</em>) – Sigma threshold for sigma clipping (default 3.0)</p></li>
<li><p><strong>norm</strong> (<em>{“i”, “t”, “u”}, optional</em>) – Normalization to use for final difference image, where “i” is the
science image, “t” the template, and “u” the unconvolved science image
or template depending on which was convolved (default “i”)</p></li>
<li><p><strong>convi</strong> (<em>bool, optional</em>) – Whether to force convolution of the science image (default False)</p></li>
<li><p><strong>convt</strong> (<em>bool, optional</em>) – Whether to force convolution of the template image (default False)</p></li>
<li><p><strong>bgo</strong> (<em>int, optional</em>) – Order of spatial variations in the background (default 0)</p></li>
<li><p><strong>ko</strong> (<em>int, optional</em>) – Order of spatial variations in the kernel (default 1)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Output difference image file name (default
<cite>science_file.replace(“.fits”, “_subtracted.fits”)</cite>)</p></li>
<li><p><strong>mask_write</strong> (<em>bool, optional</em>) – Whether to write the bad pixel mask (default False)</p></li>
<li><p><strong>conv_write</strong> (<em>bool, optional</em>) – Whether to write the convolved image (default False)</p></li>
<li><p><strong>kern_write</strong> (<em>bool, optional</em>) – Whether to write the kernel image (default False)</p></li>
<li><p><strong>noise_write</strong> (<em>bool, optional</em>) – Whether to write the noise image (default False)</p></li>
<li><p><strong>noise_scale_write</strong> (<em>bool, optional</em>) – Whether to write the <em>scaled difference</em> noise image (default False)</p></li>
<li><p><strong>maskout</strong> (<em>str, optional</em>) – Name for the output bad pixel mask if <cite>mask_write = True</cite> (default
<cite>science_file.replace(“.fits”, “_submask.fits”)</cite>)</p></li>
<li><p><strong>convout</strong> (<em>str, optional</em>) – Name for output convolved image if <cite>conv_write = True</cite> (default
<cite>science_file.replace(“.fits”, “_conv.fits”)</cite>)</p></li>
<li><p><strong>kernout</strong> (<em>str, optional</em>) – Name for output kernel if <cite>kern_write = True</cite> (default
<cite>science_file.replace(“.fits”, “_kernel.fits”)</cite>)</p></li>
<li><p><strong>noiseout</strong> (<em>str, optional</em>) – Name for output noise image if <cite>noise_write = True</cite> (default
<cite>science_file.replace(“.fits”, “_noise.fits”)</cite>)</p></li>
<li><p><strong>noisecaleout</strong> (<em>str, optional</em>) – Name for output noise <em>scaled difference</em> image if
<cite>noise_scale_write = True</cite> (default
<cite>science_file.replace(“.fits”, “_noise_scaled.fits”)</cite>)</p></li>
<li><p><strong>v</strong> (<em>{0, 1, 2}, optional</em>) – Level of verbosity, where 0 is least and 2 is most (default 1)</p></li>
<li><p><strong>log</strong> (<em>str, optional</em>) – Name for a logfile in which to store STDERR (default None)</p></li>
<li><p><strong>plot</strong> (<em>bool, optional</em>) – Whether to plot the final difference image (default True)</p></li>
<li><p><strong>plotname</strong> (<em>str, optional</em>) – Name for the output figure (default
<cite>output.replace(“.fits”, “_hotpants.png”)</cite>)</p></li>
<li><p><strong>scale</strong> (<em>{“linear”, “log”, “asinh”}, optional</em>) – Scale to apply to the plot (default “linear”)</p></li>
<li><p><strong>target_large</strong> (<em>array_like</em>) – [ra, dec] for some target of interest (e.g. a potential transient)
at which to draw a large crosshair (default None)</p></li>
<li><p><strong>target_small</strong> (<em>array_like</em>) – [ra, dec] for some other target of interest (e.g. the candidate host
galaxy of some target of interest) at which to draw a small crosshair
(default None)</p></li>
<li><p><strong>thresh_sigma</strong> (<em>float, optional</em>) – Sigma threshold for source detection with image segmentation (default
3.0)</p></li>
<li><p><strong>pixelmin</strong> (<em>float, optional</em>) – <em>Minimum</em> pixel area of an isophote to be considered a good source for
building the ePSF (default 20; passed to <cite>build_ePSF_imsegm()</cite> only
if <cite>param_estimate = True</cite>)</p></li>
<li><p><strong>etamax</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed elongation for an isophote to be considered a good
source for building the ePSF (default 1.4; passed to
<cite>build_ePSF_imsegm()</cite> only if <cite>param_estimate = True</cite>)</p></li>
<li><p><strong>areamax</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed area (in square pixels) for an isophote to be
considered a good source for building the ePSF (default 500.0, passed
to <cite>build_ePSF_imsegm()</cite> only if <cite>param_estimate = True</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New HDU (image + header) for the difference image</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.io.fits.PrimaryHDU</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For more details, see: <a class="reference external" href="https://github.com/acbecker/hotpants">https://github.com/acbecker/hotpants</a></p>
<p>High Order Transformation of Psf ANd Template Subtraction
Based (hotpants) is based on the method of “optimal image subtraction” of
Alard &amp; Lupton 1998 <a class="footnote-reference brackets" href="#id3" id="id2">1</a> .</p>
<p>Note that this wrapper does not implement <em>all</em> settings which can be
specified by the user when running hotpants directly from the command line,
but does include most of them (and all of the most important ones).</p>
<p class="rubric">References</p>
<dl class="footnote brackets">
<dt class="label" id="id3"><span class="brackets">1</span><span class="fn-backref">(<a href="#id1">1</a>,<a href="#id2">2</a>)</span></dt>
<dd><p>Alard, C., &amp; Lupton, R. H. 1998, ApJ, 503, 325
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1998ApJ...503..325A/abstract">https://ui.adsabs.harvard.edu/abs/1998ApJ…503..325A/abstract</a></p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-amakihi.astroalign_mod">
<span id="amakihi-astroalign-mod-module"></span><h2>amakihi.astroalign_mod module<a class="headerlink" href="#module-amakihi.astroalign_mod" title="Permalink to this heading"></a></h2>
<p><strong>Important:</strong> This software has been slighly modified by me (Nicholas Vieira)
for use in a CFHT image differencing pipeline. <strong>I claim no ownership for this
software.</strong> The modifications include:</p>
<ul class="simple">
<li><p>An error class for when not enough stars are supplied</p></li>
<li><p>Ability to set the detection threshold when finding sources via image
segmentation</p></li>
</ul>
<p>Documentation used here is not consistent with that used in the rest of
<cite>amakihi</cite> as this was not changed from the original <cite>astroalign</cite>.</p>
<p>The original code can be found at <a class="reference external" href="https://github.com/toros-astro/astroalign">https://github.com/toros-astro/astroalign</a></p>
<p>And the most up-to-date version of the code at
<a class="reference external" href="https://github.com/quatrope/astroalign">https://github.com/quatrope/astroalign</a></p>
<dl class="py data">
<dt class="sig sig-object py" id="amakihi.astroalign_mod.MAX_CONTROL_POINTS">
<span class="sig-prename descclassname"><span class="pre">amakihi.astroalign_mod.</span></span><span class="sig-name descname"><span class="pre">MAX_CONTROL_POINTS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">50</span></em><a class="headerlink" href="#amakihi.astroalign_mod.MAX_CONTROL_POINTS" title="Permalink to this definition"></a></dt>
<dd><p>The maximum control points (stars) to use to build the invariants.</p>
<p>Default: 50</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="amakihi.astroalign_mod.MIN_MATCHES_FRACTION">
<span class="sig-prename descclassname"><span class="pre">amakihi.astroalign_mod.</span></span><span class="sig-name descname"><span class="pre">MIN_MATCHES_FRACTION</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">0.8</span></em><a class="headerlink" href="#amakihi.astroalign_mod.MIN_MATCHES_FRACTION" title="Permalink to this definition"></a></dt>
<dd><p>The minimum fraction of triangle matches to accept a transformation.</p>
<p>If the minimum fraction yields more than 10 triangles, 10 is used instead.</p>
<p>Default: 0.8</p>
</dd></dl>

<dl class="py exception">
<dt class="sig sig-object py" id="amakihi.astroalign_mod.MaxIterError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">amakihi.astroalign_mod.</span></span><span class="sig-name descname"><span class="pre">MaxIterError</span></span><a class="headerlink" href="#amakihi.astroalign_mod.MaxIterError" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="amakihi.astroalign_mod.NUM_NEAREST_NEIGHBORS">
<span class="sig-prename descclassname"><span class="pre">amakihi.astroalign_mod.</span></span><span class="sig-name descname"><span class="pre">NUM_NEAREST_NEIGHBORS</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">5</span></em><a class="headerlink" href="#amakihi.astroalign_mod.NUM_NEAREST_NEIGHBORS" title="Permalink to this definition"></a></dt>
<dd><p>The number of nearest neighbors of a given star (including itself) to construct
the triangle invariants.</p>
<p>Default: 5</p>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="amakihi.astroalign_mod.PIXEL_TOL">
<span class="sig-prename descclassname"><span class="pre">amakihi.astroalign_mod.</span></span><span class="sig-name descname"><span class="pre">PIXEL_TOL</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">2</span></em><a class="headerlink" href="#amakihi.astroalign_mod.PIXEL_TOL" title="Permalink to this definition"></a></dt>
<dd><p>The pixel distance tolerance to assume two invariant points are the same.</p>
<p>Default: 2</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.astroalign_mod.apply_transform">
<span class="sig-prename descclassname"><span class="pre">amakihi.astroalign_mod.</span></span><span class="sig-name descname"><span class="pre">apply_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transform</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagate_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.astroalign_mod.apply_transform" title="Permalink to this definition"></a></dt>
<dd><p>Applies the transformation <code class="docutils literal notranslate"><span class="pre">transform</span></code> to <code class="docutils literal notranslate"><span class="pre">source</span></code>.</p>
<p>The output image will have the same shape as <code class="docutils literal notranslate"><span class="pre">target</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transform</strong> – A scikit-image <code class="docutils literal notranslate"><span class="pre">SimilarityTransform</span></code> object.</p></li>
<li><p><strong>source</strong> (<em>numpy array</em>) – A 2D numpy array of the source image to be
transformed.</p></li>
<li><p><strong>target</strong> (<em>numpy array</em>) – A 2D numpy array of the target image. Only used
to set the output image shape.</p></li>
<li><p><strong>fill_value</strong> (<em>float</em>) – A value to fill in the areas of aligned_image
where footprint == True.</p></li>
<li><p><strong>propagate_mask</strong> (<em>bool</em>) – Wether to propagate the mask in source.mask
onto footprint.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple (aligned_image, footprint).
aligned_image is a numpy 2D array of the transformed source
footprint is a mask 2D array with True on the regions
with no pixel information.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.astroalign_mod.estimate_transform">
<span class="sig-prename descclassname"><span class="pre">amakihi.astroalign_mod.</span></span><span class="sig-name descname"><span class="pre">estimate_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ttype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dst</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.astroalign_mod.estimate_transform" title="Permalink to this definition"></a></dt>
<dd><p>Estimate 2D geometric transformation parameters.</p>
<p>You can determine the over-, well- and under-determined parameters
with the total least-squares method.</p>
<p>Number of source and destination coordinates must match.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul>
<li><p><strong>ttype</strong> (<em>{‘euclidean’, similarity’, ‘affine’, ‘piecewise-affine’,              ‘projective’, ‘polynomial’}</em>) – Type of transform.</p></li>
<li><p><strong>kwargs</strong> (<em>array or int</em>) –</p>
<p>Function parameters (src, dst, n, angle):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>NAME / TTYPE        FUNCTION PARAMETERS
&#39;euclidean&#39;         `src, `dst`
&#39;similarity&#39;        `src, `dst`
&#39;affine&#39;            `src, `dst`
&#39;piecewise-affine&#39;  `src, `dst`
&#39;projective&#39;        `src, `dst`
&#39;polynomial&#39;        `src, `dst`, `order` (polynomial order,
                                          default order is 2)
</pre></div>
</div>
<p>Also see examples below.</p>
</li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>tform</strong> – Transform object containing the transformation parameters and providing
access to forward and inverse transformation functions.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><code class="xref py py-class docutils literal notranslate"><span class="pre">GeometricTransform</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">transform</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># estimate transformation parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">src</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dst</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">12</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">])</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tform</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">estimate_transform</span><span class="p">(</span><span class="s1">&#39;similarity&#39;</span><span class="p">,</span> <span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">tform</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="n">tform</span><span class="p">(</span><span class="n">src</span><span class="p">)),</span> <span class="n">src</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># warp image using the estimated transformation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">skimage</span> <span class="kn">import</span> <span class="n">data</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">camera</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">warp</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">inverse_map</span><span class="o">=</span><span class="n">tform</span><span class="o">.</span><span class="n">inverse</span><span class="p">)</span> 
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># create transformation with explicit parameters</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tform2</span> <span class="o">=</span> <span class="n">transform</span><span class="o">.</span><span class="n">SimilarityTransform</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="mf">1.1</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">translation</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># unite transformations, applied in order from left to right</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tform3</span> <span class="o">=</span> <span class="n">tform</span> <span class="o">+</span> <span class="n">tform2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">tform3</span><span class="p">(</span><span class="n">src</span><span class="p">),</span> <span class="n">tform2</span><span class="p">(</span><span class="n">tform</span><span class="p">(</span><span class="n">src</span><span class="p">)))</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.astroalign_mod.find_transform">
<span class="sig-prename descclassname"><span class="pre">amakihi.astroalign_mod.</span></span><span class="sig-name descname"><span class="pre">find_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.astroalign_mod.find_transform" title="Permalink to this definition"></a></dt>
<dd><p>Estimate the transform between <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">target</span></code>.</p>
<p>Return a SimilarityTransform object <code class="docutils literal notranslate"><span class="pre">T</span></code> that maps pixel x, y indices from
the source image s = (x, y) into the target (destination) image t = (x, y).
T contains parameters of the tranformation: <code class="docutils literal notranslate"><span class="pre">T.rotation</span></code>,
<code class="docutils literal notranslate"><span class="pre">T.translation</span></code>, <code class="docutils literal notranslate"><span class="pre">T.scale</span></code>, <code class="docutils literal notranslate"><span class="pre">T.params</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<em>array-like</em>) – Either a numpy array of the source image to be
transformed or an interable of (x, y) coordinates of the target
control points.</p></li>
<li><p><strong>target</strong> (<em>array-like</em>) – Either a numpy array of the target (destination)
image or an interable of (x, y) coordinates of the target
control points.</p></li>
<li><p><strong>thresh</strong> (<em>float</em>) – Sigma for source detection</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>The transformation object and a tuple of corresponding star positions
in source and target.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">T</span><span class="p">,</span> <span class="p">(</span><span class="n">source_pos_array</span><span class="p">,</span> <span class="n">target_pos_array</span><span class="p">)</span>
</pre></div>
</div>
</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TypeError</strong> – If input type of <code class="docutils literal notranslate"><span class="pre">source</span></code> or <code class="docutils literal notranslate"><span class="pre">target</span></code> is not supported.</p></li>
<li><p><strong>Exception</strong> – If it cannot find more than 3 stars on any input.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.astroalign_mod.matrix_transform">
<span class="sig-prename descclassname"><span class="pre">amakihi.astroalign_mod.</span></span><span class="sig-name descname"><span class="pre">matrix_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coords</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">matrix</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.astroalign_mod.matrix_transform" title="Permalink to this definition"></a></dt>
<dd><p>Apply 2D matrix transform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coords</strong> (<em>(N, 2) array</em>) – x, y coordinates to transform</p></li>
<li><p><strong>matrix</strong> (<em>(3, 3) array</em>) – Homogeneous transformation matrix.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>coords</strong> – Transformed coordinates.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(N, 2) array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.astroalign_mod.register">
<span class="sig-prename descclassname"><span class="pre">amakihi.astroalign_mod.</span></span><span class="sig-name descname"><span class="pre">register</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_value</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propagate_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.astroalign_mod.register" title="Permalink to this definition"></a></dt>
<dd><p>Transform <code class="docutils literal notranslate"><span class="pre">source</span></code> to coincide pixel to pixel with <code class="docutils literal notranslate"><span class="pre">target</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source</strong> (<em>numpy array</em>) – A 2D numpy array of the source image to be
transformed.</p></li>
<li><p><strong>target</strong> (<em>numpy array</em>) – A 2D numpy array of the target image. Only used
to set the output image shape.</p></li>
<li><p><strong>fill_value</strong> (<em>float</em>) – A value to fill in the areas of aligned_image
where footprint == True.</p></li>
<li><p><strong>propagate_mask</strong> (<em>bool</em>) – Wether to propagate the mask in source.mask
onto footprint.
thresh (float): Sigma for source detection</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple (aligned_image, footprint).
aligned_image is a numpy 2D array of the transformed source
footprint is a mask 2D array with True on the regions
with no pixel information.</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-amakihi.background">
<span id="amakihi-background-module"></span><h2>amakihi.background module<a class="headerlink" href="#module-amakihi.background" title="Permalink to this heading"></a></h2>
<p>Background estimation and subtraction.</p>
<dl class="py function">
<dt class="sig sig-object py" id="amakihi.background.bkgsub">
<span class="sig-prename descclassname"><span class="pre">amakihi.background.</span></span><span class="sig-name descname"><span class="pre">bkgsub</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkg_box</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(5,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkg_filt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(5,</span> <span class="pre">5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_bkg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_bkgsubbed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_bkg</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_bkgsubbed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.background.bkgsub" title="Permalink to this definition"></a></dt>
<dd><p>Subtract the background from an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im_file</strong> (<em>str</em>) – Filename for image of interest</p></li>
<li><p><strong>mask_file</strong> (<em>str, optional</em>) – Filename for bad pixels mask (default None)</p></li>
<li><p><strong>bkg_box</strong> (<em>tuple, optional</em>) – Sizes of box along each axis in which background is estimated (default
(5,5))</p></li>
<li><p><strong>bkg_filt</strong> (<em>tuple, optional</em>) – Size of the median filter pre-applied to the background before
background estimation (default (5,5) where (1,1) –&gt; no filtering)</p></li>
<li><p><strong>plot_bkg</strong> (<em>bool, optional</em>) – Whether to plot BACKGROUND image (default False)</p></li>
<li><p><strong>plot_bkgsubbed</strong> (<em>bool, optional</em>) – Whether to plot background-SUBTRACTED image (default False)</p></li>
<li><p><strong>scale_bkg</strong> (<em>{“linear”, “log”, “asinh”}, optional</em>) – Scale to apply to BACKGROUND image plot (default “linear”)</p></li>
<li><p><strong>scale_bkgsubbed</strong> (<em>{“linear”, “log”, “asinh”}, optional</em>) – Scale to apply to background-SUBTRACTED image plot (default “linear”)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Whether to write the background-SUBTRACTED image to a fits file
(default True)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output fits file (default
<cite>im_file.replace(“.fits”, “_bkgsub.fits”)</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New HDU (image + header) with the image background-subtracted</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.io.fits.PrimaryHDU</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><strong>TO-DO:</strong></p>
<ul class="simple">
<li><p>Allow naming of output plots</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.background.bkgstd">
<span class="sig-prename descclassname"><span class="pre">amakihi.background.</span></span><span class="sig-name descname"><span class="pre">bkgstd</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.background.bkgstd" title="Permalink to this definition"></a></dt>
<dd><p>Estimate the RMS standard deviation of the background in the <cite>im_data</cite>
image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im_data</strong> (<em>array_like</em>) – Image data</p></li>
<li><p><strong>mask</strong> (<em>array_like</em>) – Mask to apply to image</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>RMS standard deviation of the background image</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-amakihi.crop">
<span id="amakihi-crop-module"></span><h2>amakihi.crop module<a class="headerlink" href="#module-amakihi.crop" title="Permalink to this heading"></a></h2>
<p>This module enables cropping (and optionally writing) fits images by either WCS
or pixel coords.</p>
<dl class="py function">
<dt class="sig sig-object py" id="amakihi.crop.crop_WCS">
<span class="sig-prename descclassname"><span class="pre">amakihi.crop.</span></span><span class="sig-name descname"><span class="pre">crop_WCS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'truncate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.crop.crop_WCS" title="Permalink to this definition"></a></dt>
<dd><p>Crop an image based on some central WCS coordinates of interest.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>source_file</strong> (<em>str</em>) – Filename for a single fits file</p></li>
<li><p><strong>ra, dec</strong> (<em>float</em>) – Right Ascension, Declination to center on, in decimal degrees</p></li>
<li><p><strong>size</strong> (<em>float</em>) – Size of the box (in pixels) to crop</p></li>
<li><p><strong>mode</strong> (<em>{“truncate”, “extend”}, optional</em>) – Mode to apply if the requested crop lies outside of the image bounds
(default “truncate”, see notes for details)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Whether to write the output to a .fits file (default True)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output fits file (default
<cite>source_file.replace(“.fits”, “_crop.fits”)</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New HDU (image + header) with the image cropped and header partially
updated</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.io.fits.PrimaryHDU</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Crops the image of the fits file to a box of size <cite>pixels</cite> pix centered on
RA and Dec <cite>ra, dec</cite>. If given box extends beyond bounds of image, there
are two possibilities:</p>
<ul class="simple">
<li><p><cite>mode = “truncate”</cite> –&gt; Cropped image will be rectangular rather than
square, and truncated at the bounds</p></li>
<li><p><cite>mode = “extend”</cite> –&gt; Re-center the crop on a new set of coords such that
the output cropped image is still a square</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.crop.crop_frac">
<span class="sig-prename descclassname"><span class="pre">amakihi.crop.</span></span><span class="sig-name descname"><span class="pre">crop_frac</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_hori</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">frac_vert</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">1]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.crop.crop_frac" title="Permalink to this definition"></a></dt>
<dd><p>Crop a .fits file’s image according to some horizontal and vertical
fraction of interest, and optionally write it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fits_file</strong> (<em>str</em>) – Filename for a single fits file</p></li>
<li><p><strong>frac_hori, frac_vert</strong> (<em>array_like, optional</em>) – Horizontal and vertical fractions of the image to crop (default [0, 1]
for both, in which case no cropping is performed)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Whether to write the output to a .fits file (default True)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output fits file (default
<cite>source_file.replace(“.fits”, “_crop.fits”)</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New HDU (image + header) with the image cropped and header partially
updated</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.io.fits.PrimaryHDU</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>The following would crop to select the bottom right corner of the image and
write it to a new file “bar.fits”:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">crop_frac</span><span class="p">(</span><span class="s2">&quot;foo.fits&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">write</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;bar.fits&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.crop.crop_half">
<span class="sig-prename descclassname"><span class="pre">amakihi.crop.</span></span><span class="sig-name descname"><span class="pre">crop_half</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.crop.crop_half" title="Permalink to this definition"></a></dt>
<dd><p>Given some Right Ascension and Declination, find the half of the image
which contains these coordinates, crop to select that half, and optionally
write it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fits_file</strong> (<em>str</em>) – Filename for a single fits file</p></li>
<li><p><strong>ra, dec</strong> (<em>float</em>) – Right Ascension, Declination of interest</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Whether to write the output to a .fits file (default True)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output fits file (default
<cite>source_file.replace(“.fits”, “_crop.fits”)</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New HDU (image + header) with the image cropped and header partially
updated</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.io.fits.PrimaryHDU</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For a given, RA, Dec, finds the half of the image in which these coords
are found. This can be the top half, bottom half, or a box centered on the
center of the overall image. Then crops the image. Best for images with an
aspect ratio of around 2:1 (e.g. MegaCam CCDs) such that the output crop is
approximately square.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.crop.crop_octant">
<span class="sig-prename descclassname"><span class="pre">amakihi.crop.</span></span><span class="sig-name descname"><span class="pre">crop_octant</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">source_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.crop.crop_octant" title="Permalink to this definition"></a></dt>
<dd><p>Given some Right Ascension and Declination, find the octant of the image
which contains these coordinates, crop to select that octant, and
optionally write it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fits_file</strong> (<em>str</em>) – Filename for a single fits file</p></li>
<li><p><strong>ra, dec</strong> (<em>float</em>) – Right Ascension, Declination of interest</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Whether to write the output to a .fits file (default True)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output fits file (default
<cite>source_file.replace(“.fits”, “_crop.fits”)</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New HDU (image + header) with the image cropped and header partially
updated</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.io.fits.PrimaryHDU</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For a given, RA, Dec, finds the octant-sized ~square of the image in which
these coords are found. Then crops the image to this octant. Best for
images with an aspect ratio of around 2:1 (e.g. MegaCam CCDs) such that
the output crop is approximately square.</p>
</dd></dl>

</section>
<section id="module-amakihi.crossmatch">
<span id="amakihi-crossmatch-module"></span><h2>amakihi.crossmatch module<a class="headerlink" href="#module-amakihi.crossmatch" title="Permalink to this heading"></a></h2>
<p>Functions for cross-matching candidate transients yielded by <cite>amakihi</cite> with
lists of known transients, transients from the Transient Name Server (TNS),
catalogues of variable star, quasars, active galactic nuclei, etc.</p>
<dl class="py function">
<dt class="sig sig-object py" id="amakihi.crossmatch.crossmatch_list">
<span class="sig-prename descclassname"><span class="pre">amakihi.crossmatch.</span></span><span class="sig-name descname"><span class="pre">crossmatch_list</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossmatch_ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crossmatch_dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tripfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab_crossmatch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_trips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.crossmatch.crossmatch_list" title="Permalink to this definition"></a></dt>
<dd><p>Given some candidate transients, search for matches within <cite>sep_max</cite>
arcseconds of some <cite>(crossmatch_ra, crossmatch_dec)</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabfile</strong> (<em>str</em>) – Table of candidate transients (must be a .csv or .fits file)</p></li>
<li><p><strong>crossmatch_ra, crossmatch_dec</strong> (<em>array_like</em>) – Lists of RA and Dec to crossmatch to; must be in degrees</p></li>
<li><p><strong>tripfile</strong> (<em>str, optional</em>) – .npy file containing triplets corresponding to <cite>tabfile</cite> (default
None; if provided, will write matches to a new file)</p></li>
<li><p><strong>sep_max</strong> (<em>float, optional</em>) – Maximum separation to consider two sources to be the same, in
arcseconds (default 2.0)</p></li>
<li><p><strong>output_tab</strong> (<em>str, optional</em>) – Name for output table with candidate transients which were
successfully crossmatched (default set by function)</p></li>
<li><p><strong>output_tab_crossmatch</strong> (<em>str, optional</em>) – Name for output table with RA, Dec which were successfully
crossmatched (default set by function)</p></li>
<li><p><strong>output_trips</strong> (<em>str, optional</em>) – Name for output .npy file with crossmatched triplets (default set by
function)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For a single .fits or .csv table containing N transient candidates and a
single triplet .npy file containing N triplets, looks for candidates which
are within <cite>sep_max</cite> arcseconds of pairs (ra, dec) given by the input
lists <cite>crossmatch_ra</cite> and <cite>crossmatch_dec</cite>. If M&gt;0 matches are found,
writes a table containing the M crossmatched transient candidates, another
tablecontaining just the RA, Dec of the M crossmatched sources, and a
(M,3,Y,X) .npy file containing the M relevant triplets.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.crossmatch.crossmatch_table">
<span class="sig-prename descclassname"><span class="pre">amakihi.crossmatch.</span></span><span class="sig-name descname"><span class="pre">crossmatch_table</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transient_tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tripfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab_transients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_trips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.crossmatch.crossmatch_table" title="Permalink to this definition"></a></dt>
<dd><p>Given some tables of candidate transients and known transients, search
for matches within <cite>sep_max</cite> arcseconds of each other</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabfile</strong> (<em>str</em>) – Table of candidate transients (must be a .csv or .fits file)</p></li>
<li><p><strong>transient_tabfile</strong> (<em>str</em>) – Table of known transients from whatever source (must have, at
minimum, ‘RA’/’ra’/’RAJ2000’ and ‘DEC’/’dec’/’DEJ2000’ columns;
must be .csv or .fits file)</p></li>
<li><p><strong>tripfile</strong> (<em>str, optional</em>) – .npy file containing triplets corresponding to <cite>tabfile</cite> (default
None; if provided, will write matches to a new file)</p></li>
<li><p><strong>sep_max</strong> (<em>float, optional</em>) – Maximum separation to consider two sources to be the same, in
arcseconds (default 2.0)</p></li>
<li><p><strong>match</strong> (<em>bool, optional</em>) – Look for matches? or look for non-matches (default True)</p></li>
<li><p><strong>output_tab</strong> (<em>str, optional</em>) – Name for output table with candidate transients which were
successfully crossmatched (default set by function)</p></li>
<li><p><strong>output_tab_transients</strong> (<em>str, optional</em>) – Name for output table with <strong>known</strong> transients which were
successfully crossmatched (default set by function)</p></li>
<li><p><strong>output_trips</strong> (<em>str, optional</em>) – Name for output .npy file with crossmatched triplets (default set by
function)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For a single .fits or .csv table containing N transient candidates and a
single triplet .npy file containing N triplets, looks for candidates which
are within <cite>sep_max</cite> arcsec of known transients provided via the .fits /
.csv table <cite>transient_tabfile</cite>. If M&gt;0 matches are found, writes a table
containing the M crossmatched transient <em>candidates</em>, another table
containing the M <em>known</em> transients, and a (M,3,Y,X) .npy file containing
the M relevant triplets.</p>
<p>Bug: files are overwritten if tabfile and known_transient_table have
different file extensions?</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.crossmatch.crossmatch_TNS">
<span class="sig-prename descclassname"><span class="pre">amakihi.crossmatch.</span></span><span class="sig-name descname"><span class="pre">crossmatch_TNS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TNS_tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tripfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab_TNS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_trips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.crossmatch.crossmatch_TNS" title="Permalink to this definition"></a></dt>
<dd><p>Given some tables of candidate transients and known treansients from
the Transient Name Server (TNS), search for matches within <cite>sep_max</cite>
arcseconds of each other</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabfile</strong> (<em>str</em>) – Table of candidate transients (must be a .csv or .fits file)</p></li>
<li><p><strong>TNS_tabfile</strong> (<em>str</em>) – Table of known transients from Transient Name Server (must be a .csv)</p></li>
<li><p><strong>tripfile</strong> (<em>str, optional</em>) – .npy file containing triplets corresponding to <cite>tabfile</cite> (default
None; if provided, will write matches to a new file)</p></li>
<li><p><strong>sep_max</strong> (<em>float, optional</em>) – Maximum separation to consider two sources to be the same, in
arcseconds (default 2.0)</p></li>
<li><p><strong>match</strong> (<em>bool, optional</em>) – Look for matches? or look for non-matches (default True)</p></li>
<li><p><strong>output_tab</strong> (<em>str, optional</em>) – Name for output table with candidate transients which were
successfully crossmatched (default set by function)</p></li>
<li><p><strong>output_tab_TNS</strong> (<em>str, optional</em>) – Name for output table with <strong>TNS</strong> transients which were successfully
crossmatched (default set by function)</p></li>
<li><p><strong>output_trips</strong> (<em>str, optional</em>) – Name for output .npy file with crossmatched triplets (default set by
function)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For a single .fits or .csv table containing N transient candidates and a
single triplet .npy file containing N triplets, looks for candidates which
are within <cite>sep_max</cite> arcsec of known transients provided via the .csv
table <cite>TNS_tabfile</cite>, which must come the Transient Name Server’s querying
page. If M&gt;0 matches are found, writes a table containing the M
crossmatched transient <em>candidates</em>, another table containing the M
<em>known</em> TNS sources, and a <cite>(M,3,Y,X)</cite> .npy file containing the M relevant
triplets.</p>
<p>The .csv of TNS files must have been previously downloaded. In the future,
will write a function which queries the TNS in real-time.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.crossmatch.crossmatch_GCVS">
<span class="sig-prename descclassname"><span class="pre">amakihi.crossmatch.</span></span><span class="sig-name descname"><span class="pre">crossmatch_GCVS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tripfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab_GCVS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_trips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.crossmatch.crossmatch_GCVS" title="Permalink to this definition"></a></dt>
<dd><p>Given a table of candidate transients, search for cross-matches in the
General Catalogue of Variable Stars (GCVS), within <cite>sep_max</cite> arcseconds of
each other</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabfile</strong> (<em>str</em>) – Table of candidate transients (must be a .csv or .fits file)</p></li>
<li><p><strong>tripfile</strong> (<em>str, optional</em>) – .npy file containing triplets corresponding to <cite>tabfile</cite> (default
None; if provided, will write matches to a new file)</p></li>
<li><p><strong>sep_max</strong> (<em>float, optional</em>) – Maximum separation to consider two sources to be the same, in
arcseconds (default 2.0)</p></li>
<li><p><strong>match</strong> (<em>bool, optional</em>) – Look for matches? or look for non-matches (default True)</p></li>
<li><p><strong>output_tab</strong> (<em>str, optional</em>) – Name for output table with candidate transients which were
successfully crossmatched (default set by function)</p></li>
<li><p><strong>output_tab_GCVS</strong> (<em>str, optional</em>) – Name for output table with <strong>GCVS</strong> transients which were successfully
crossmatched (default set by function)</p></li>
<li><p><strong>output_trips</strong> (<em>str, optional</em>) – Name for output .npy file with crossmatched triplets (default set by
function)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For a single .fits or .csv table containing N transient candidates and a
single triplet .npy file containing N triplets, queries the General
Catalog of Variable Stars (~55,000 stars as of 22 November 2019) for
sources within <cite>sep_max</cite> arcsec of the candidate transients. If M&gt;0
matches are found, writes a table containing the M crossmatched transient
<em>candidates</em>, another table containing the M <em>known</em> GCVS variable stars,
and a <cite>(M,3,Y,X)</cite> .npy file containing the M relevant triplets.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.crossmatch.crossmatch_AAVSO">
<span class="sig-prename descclassname"><span class="pre">amakihi.crossmatch.</span></span><span class="sig-name descname"><span class="pre">crossmatch_AAVSO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tripfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab_AAVSO</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_trips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.crossmatch.crossmatch_AAVSO" title="Permalink to this definition"></a></dt>
<dd><p>Given a table of candidate transients, search for cross-matches in the
American Association of Variable Star Observers (AAVSO) International
Variable Star Index (VSX) within <cite>sep_max</cite> arcseconds of each other</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabfile</strong> (<em>str</em>) – Table of candidate transients (must be a .csv or .fits file)</p></li>
<li><p><strong>tripfile</strong> (<em>str, optional</em>) – .npy file containing triplets corresponding to <cite>tabfile</cite> (default
None; if provided, will write matches to a new file)</p></li>
<li><p><strong>sep_max</strong> (<em>float, optional</em>) – Maximum separation to consider two sources to be the same, in
arcseconds (default 2.0)</p></li>
<li><p><strong>match</strong> (<em>bool, optional</em>) – Look for matches? or look for non-matches (default True)</p></li>
<li><p><strong>output_tab</strong> (<em>str, optional</em>) – Name for output table with candidate transients which were
successfully crossmatched (default set by function)</p></li>
<li><p><strong>output_tab_AAVSO</strong> (<em>str, optional</em>) – Name for output table with <strong>AAVSO</strong> transients which were
successfully crossmatched (default set by function)</p></li>
<li><p><strong>output_trips</strong> (<em>str, optional</em>) – Name for output .npy file with crossmatched triplets (default set by
function)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For a single .fits or .csv table containing N transient candidates and a
single triplet .npy file containing N triplets, queries the American
Association of Variable Star Observers (AAVSO) International Variable Star
indeX (VSX, ~2 million stars as of 22 November 2019) for sources within
<cite>sep_max</cite> arcsec of the candidate transients. If M&gt;0 matches are found,
writes a table containing the M crossmatched transient <em>candidates</em>,
another table containing the M <em>known</em> AAVSO variable stars, and a
<cite>(M,3,Y,X)</cite> .npy file containing the M relevant triplets.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.crossmatch.crossmatch_VeronCettyVeron">
<span class="sig-prename descclassname"><span class="pre">amakihi.crossmatch.</span></span><span class="sig-name descname"><span class="pre">crossmatch_VeronCettyVeron</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tripfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab_VCV</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_trips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.crossmatch.crossmatch_VeronCettyVeron" title="Permalink to this definition"></a></dt>
<dd><p>Given a table of candidate transients, search for cross-matches in the
Veron-Cetty and Veron catalogue of quasars, within <cite>sep_max</cite> arcseconds of
each other</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabfile</strong> (<em>str</em>) – Table of candidate transients (must be a .csv or .fits file)</p></li>
<li><p><strong>tripfile</strong> (<em>str, optional</em>) – .npy file containing triplets corresponding to <cite>tabfile</cite> (default
None; if provided, will write matches to a new file)</p></li>
<li><p><strong>sep_max</strong> (<em>float, optional</em>) – Maximum separation to consider two sources to be the same, in
arcseconds (default 2.0)</p></li>
<li><p><strong>match</strong> (<em>bool, optional</em>) – Look for matches? or look for non-matches (default True)</p></li>
<li><p><strong>output_tab</strong> (<em>str, optional</em>) – Name for output table with candidate transients which were
successfully crossmatched (default set by function)</p></li>
<li><p><strong>output_tab_VCV</strong> (<em>str, optional</em>) – Name for output table with <strong>Veron-Cetty and Veron</strong> quasars which
were successfully crossmatched (default set by function)</p></li>
<li><p><strong>output_trips</strong> (<em>str, optional</em>) – Name for output .npy file with crossmatched triplets (default set by
function)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For a single .fits or .csv table containing N transient candidates and a
single triplet .npy file containing N triplets, queries the Veron-Cetty &amp;
Veron catalogue of quasars and active galactic nuclei (13ed, Veron-Cetty &amp;
Veron 2010) for sources within <cite>sep_max</cite> arcsec of the candidate
transients. If M&gt;0 matches are found, writes a table containing the M
crossmatched transient <em>candidates</em>, another table containing the M
<em>known</em> quasars/AGN, and a <cite>(M,3,Y,X)</cite> .npy file containing the M relevant
triplets.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.crossmatch.crossmatch_MILLIQUAS">
<span class="sig-prename descclassname"><span class="pre">amakihi.crossmatch.</span></span><span class="sig-name descname"><span class="pre">crossmatch_MILLIQUAS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tripfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab_MILLIQUAS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_trips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.crossmatch.crossmatch_MILLIQUAS" title="Permalink to this definition"></a></dt>
<dd><p>Given a table of candidate transients, search for cross-matches in the
Million Quasars (MILLIQUAS) catalogue of quasars, within <cite>sep_max</cite>
arcseconds of each other</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabfile</strong> (<em>str</em>) – Table of candidate transients (must be a .csv or .fits file)</p></li>
<li><p><strong>tripfile</strong> (<em>str, optional</em>) – .npy file containing triplets corresponding to <cite>tabfile</cite> (default
None; if provided, will write matches to a new file)</p></li>
<li><p><strong>sep_max</strong> (<em>float, optional</em>) – Maximum separation to consider two sources to be the same, in
arcseconds (default 2.0)</p></li>
<li><p><strong>match</strong> (<em>bool, optional</em>) – Look for matches? or look for non-matches (default True)</p></li>
<li><p><strong>output_tab</strong> (<em>str, optional</em>) – Name for output table with candidate transients which were
successfully crossmatched (default set by function)</p></li>
<li><p><strong>output_tab_MILLIQUAS</strong> (<em>str, optional</em>) – Name for output table with <strong>MILLIQUAS</strong> quasars which were
successfully crossmatched (default set by function)</p></li>
<li><p><strong>output_trips</strong> (<em>str, optional</em>) – Name for output .npy file with crossmatched triplets (default set by
function)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For a single .fits or .csv table containing N transient candidates and a
single triplet .npy file containing N triplets, queries the Million
Quasars (MILLIQUAS) catalogue of quasars (v6.3, Flesch 2019, updated 16
June 2019) for sources within <cite>sep_max</cite> arcsec of the candidate
transients. If M&gt;0 matches are found, writes a table containing the M
crossmatched transient <em>candidates</em>, another table containing the M
<em>known</em> quasars, and a <cite>(M,3,Y,X)</cite> .npy file containing the M relevant
triplets.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.crossmatch.crossmatch_PS1_stellar">
<span class="sig-prename descclassname"><span class="pre">amakihi.crossmatch.</span></span><span class="sig-name descname"><span class="pre">crossmatch_PS1_stellar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tripfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">match</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab_PS1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_trips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.crossmatch.crossmatch_PS1_stellar" title="Permalink to this definition"></a></dt>
<dd><p>Given a table of candidate transients, search for cross-matches among
the stellar sources in the Pan-STARSS1 3pi catalogue, within <cite>sep_max</cite>
arcseconds of each other</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabfile</strong> (<em>str</em>) – Table of candidate transients (must be a .csv or .fits file)</p></li>
<li><p><strong>tripfile</strong> (<em>str, optional</em>) – .npy file containing triplets corresponding to <cite>tabfile</cite> (default
None; if provided, will write matches to a new file)</p></li>
<li><p><strong>sep_max</strong> (<em>float, optional</em>) – Maximum separation to consider two sources to be the same, in
arcseconds (default 2.0)</p></li>
<li><p><strong>match</strong> (<em>bool, optional</em>) – Look for matches? or look for non-matches (default True)</p></li>
<li><p><strong>output_tab</strong> (<em>str, optional</em>) – Name for output table with candidate transients which were
successfully crossmatched (default set by function)</p></li>
<li><p><strong>output_tab_PS1</strong> (<em>str, optional</em>) – Name for output table with <strong>Pan-STARSS1</strong> stars which were
successfully crossmatched (default set by function)</p></li>
<li><p><strong>output_trips</strong> (<em>str, optional</em>) – Name for output .npy file with crossmatched triplets (default set by
function)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For a single .fits or .csv table containing N transient candidates and a
single triplet .npy file containing N triplets, queries the Pan-STARRS1
3pi survey (Chambers et al 2016) for <strong>stellar</strong> sources within <cite>sep_max</cite>
arcseconds of the candidate transients. If M&gt;0 matches are found, writes a
table containing the M crossmatched transient  <em>candidates</em>, another table
containing the M <em>known</em> quasars, and a <cite>(M,3,Y,X)</cite> .npy file containing
the M relevant triplets.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.crossmatch.MOC_crossmatch_TNS">
<span class="sig-prename descclassname"><span class="pre">amakihi.crossmatch.</span></span><span class="sig-name descname"><span class="pre">MOC_crossmatch_TNS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moc_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">TNS_tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab_TNS</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.crossmatch.MOC_crossmatch_TNS" title="Permalink to this definition"></a></dt>
<dd><p>Given a Multi-Order Coverage (MOC) map and table of transients from the
Transient Name Server (TNS), identify TNS transients which lie in the MOC
footprint</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>moc_file</strong> (<em>str</em>) – .fits file containing MOC</p></li>
<li><p><strong>TNS_tabfile</strong> (<em>str</em>) – Table of known transients from Transient Name Server (must be a .csv)</p></li>
<li><p><strong>output_tab_TNS</strong> (<em>str, optional</em>) – Name for output table with <strong>TNS</strong> transients which were successfully
crossmatched (default set by function)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Table of TNS sources in the MOC footprint</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.table.Table</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Given some table of sources from TNS, produces a table of only those
sources which are also in the footprint defined by the MOC.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.crossmatch.MOC_crossmatch_AAVSO">
<span class="sig-prename descclassname"><span class="pre">amakihi.crossmatch.</span></span><span class="sig-name descname"><span class="pre">MOC_crossmatch_AAVSO</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">moc_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab_AAVSO</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.crossmatch.MOC_crossmatch_AAVSO" title="Permalink to this definition"></a></dt>
<dd><p>Find AAVSO sources in the region defined by some Multi-Order Coverage
(MOC) map</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>moc_file</strong> (<em>str</em>) – .fits file containing MOC</p></li>
<li><p><strong>output_tab_AAVSO</strong> (<em>str, optional</em>) – Name for output table with <strong>AAVSO</strong> transients which were successfully
crossmatched (default set by function)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Table of American Association of Variable Star Observers (AAVSO)
international Variable Source indeX (VSC) sources in the MOC
footprint</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.table.Table</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Gets a very barebones table of all AAVSO sources present in an input MOC
file by querying Vizier.</p>
</dd></dl>

</section>
<section id="module-amakihi.ePSF">
<span id="amakihi-epsf-module"></span><h2>amakihi.ePSF module<a class="headerlink" href="#module-amakihi.ePSF" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="amakihi.ePSF.ePSF_FWHM">
<span class="sig-prename descclassname"><span class="pre">amakihi.ePSF.</span></span><span class="sig-name descname"><span class="pre">ePSF_FWHM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epsf_data</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.ePSF.ePSF_FWHM" title="Permalink to this definition"></a></dt>
<dd><p>Estimate the full width at half max (FWHM) of a 2D ePSF.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epsf_data</strong> (<em>str OR np.ndarray</em>) – Filename for a fits file containing the ePSF data <strong>OR</strong> the 2D array
representing the ePSF directly</p></li>
<li><p><strong>verbose</strong> (<em>bool, optional</em>) – Whether to be verbose (default Faulse)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>FWHM of the input ePSF</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.ePSF.build_ePSF_imsegm">
<span class="sig-prename descclassname"><span class="pre">amakihi.ePSF.</span></span><span class="sig-name descname"><span class="pre">build_ePSF_imsegm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nstars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixelmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etamax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">areamax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">35</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.ePSF.build_ePSF_imsegm" title="Permalink to this definition"></a></dt>
<dd><p>Build the effective Point-Spread Function using a sample of stars from
some image acquired via image segmentation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_file</strong> (<em>str</em>) – Filename for a <strong>background-subtracted</strong> image</p></li>
<li><p><strong>mask_file</strong> (<em>str, optional</em>) – Filename for a mask file (default None)</p></li>
<li><p><strong>nstars</strong> (<em>int, optional</em>) – <em>Maximum</em> number of stars to use in building the ePSF (default 40;
set to None to impose no limit)</p></li>
<li><p><strong>thresh_sigma</strong> (<em>float, optional</em>) – Sigma threshold for source detection with image segmentation (default
5.0)</p></li>
<li><p><strong>pixelmin</strong> (<em>float, optional</em>) – <em>Minimum</em> pixel area of an isophote to be considered a good source for
building the ePSF (default 20)</p></li>
<li><p><strong>etamax</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed elongation for an isophote to be considered a good
source for building the ePSF (default 1.4)</p></li>
<li><p><strong>areamax</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed area (in square pixels) for an isophote to be
considered a good source for building the ePSF (default 500)</p></li>
<li><p><strong>cutout</strong> (<em>int, optional</em>) – Cutout size around each star in pixels (default 35; must be <strong>odd</strong>;
rounded <strong>down</strong> if even)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Whether to write the ePSF to a new fits file (default True)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for the output ePSF data fits file (default
<cite>image_file.replace(“.fits”, “_ePSF.fits”)</cite>)</p></li>
<li><p><strong>plot</strong> (<em>bool, optional</em>) – Whether to plot the newly-built ePSF (default False)</p></li>
<li><p><strong>output_plot</strong> (<em>str, optional</em>) – Name for the output figure (default
<cite>image_file.replace(“.fits”, “_ePSF.png”)</cite>)</p></li>
<li><p><strong>verbose</strong> (<em>bool, optional</em>) – Whether to be verbose (default False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The ePSF data in a 2D array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses image segmentation via <cite>photutils</cite> to obtain a list of sources in the
image with their x, y coordinates, flux, and background at their
location. Then uses <cite>EPSFBuilder</cite> to empirically obtain the ePSF of these
stars. Optionally writes and/or plots the obtained ePSF.</p>
<p><strong>The ePSF obtained here should not be used in convolutions.</strong> Instead, it
can serve as a tool for estimating the seeing of an image.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.ePSF.build_ePSF_astrometry">
<span class="sig-prename descclassname"><span class="pre">amakihi.ePSF.</span></span><span class="sig-name descname"><span class="pre">build_ePSF_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nstars</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">image_source_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrom_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lowper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">highper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.9</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">35</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.ePSF.build_ePSF_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Build the effective Point-Spread Function using a sample of stars from
some image acquired via the <cite>image2xy</cite> tool of <cite>astrometry.net</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_file</strong> (<em>str</em>) – Filename for a <strong>background-subtracted</strong> image</p></li>
<li><p><strong>mask_file</strong> (<em>str, optional</em>) – Filename for a mask file (default None)</p></li>
<li><p><strong>nstars</strong> (<em>int, optional</em>) – <em>Maximum</em> number of stars to use in building the ePSF (default 40;
set to None to impose no limit)</p></li>
<li><p><strong>image_source_file</strong> (<em>str, optional</em>) – Filename for a <cite>.xy.fits</cite> file containing detected sources with their
pixel coordinates and <strong>background-subtracted</strong> flux (default None, in
which case a new such file is produced)</p></li>
<li><p><strong>astrom_sigma</strong> (<em>float, optional</em>) – Detection significance when using <cite>image2xy</cite> in <cite>astrometry.net</cite> to
find sources (default 5.0)</p></li>
<li><p><strong>psf_sigma</strong> (<em>float, optional</em>) – Sigma of the approximate Gaussian PSF of the images (default 5.0)</p></li>
<li><p><strong>alim</strong> (<em>int, optional</em>) – <em>Maximum</em> allowed source area in square pixels for <cite>astrometry.net</cite>,
above which sources will be deblended (default 10000)</p></li>
<li><p><strong>lowper, highper</strong> (<em>float, optional</em>) – Lower and upper flux percentiles (as a fraction between 0 and 1) such
that sources outside the corresponding flux range will be excluded from
ePSF building (default 0.6 and 0.9, respectively)</p></li>
<li><p><strong>keep</strong> (<em>bool, optional</em>) – Whether to keep the source list file (<cite>.xy.fits</cite> files; default False)</p></li>
<li><p><strong>cutout</strong> (<em>int, optional</em>) – Cutout size around each star in pixels (default 35; must be <strong>odd</strong>;
rounded <strong>down</strong> if even)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Whether to write the ePSF to a new fits file (default True)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for the output ePSF data fits file (default
<cite>image_file.replace(“.fits”, “_ePSF.fits”)</cite>)</p></li>
<li><p><strong>plot</strong> (<em>bool, optional</em>) – Whether to plot the newly-built ePSF (default False)</p></li>
<li><p><strong>output_plot</strong> (<em>str, optional</em>) – Name for the output figure (default
<cite>image_file.replace(“.fits”, “_ePSF.png”)</cite>)</p></li>
<li><p><strong>verbose</strong> (<em>bool, optional</em>) – Whether to be verbose (default False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The ePSF data in a 2D array</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses <cite>astrometry.net</cite> to obtain a list of sources in the image with their
x, y coordinates, flux, and background at their location. (If a list of
sources has already been obtained <cite>solve-field</cite> or <cite>image2xy</cite>, this can
be input). Finally, selects stars between the <cite>lowper</cite> th and <cite>highper</cite>
percentile fluxes.</p>
<p>Finally, uses <cite>EPSFBuilder</cite> to empirically obtain the ePSF of these stars.
Optionally writes and/or plots the obtained ePSF.</p>
<p><strong>The ePSF obtained here should not be used in convolutions.</strong> Instead, it
can serve as a tool for estimating the seeing of an image.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.ePSF.convolve_self">
<span class="sig-prename descclassname"><span class="pre">amakihi.ePSF.</span></span><span class="sig-name descname"><span class="pre">convolve_self</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixelmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etamax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">areamax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">35</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf_fwhm_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">7.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'gauss'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">alpha</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.ePSF.convolve_self" title="Permalink to this definition"></a></dt>
<dd><p>Using a sample of stars detected by image segmentation, construct the
ePSF of an image (using <cite>build_ePSF_imsegm()</cite>), fit the ePSF with a
Gaussian or Moffat kernel, and then convolve the image with this kernel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_file</strong> (<em>str</em>) – Filename for a <strong>background-subtracted</strong> image</p></li>
<li><p><strong>mask_file</strong> (<em>str, optional</em>) – Filename for a mask file (default None)</p></li>
<li><p><strong>nstars</strong> (<em>int, optional</em>) – <em>Maximum</em> number of stars to use in building the ePSF (default 40;
set to None to impose no limit)</p></li>
<li><p><strong>thresh_sigma</strong> (<em>float, optional</em>) – Sigma threshold for source detection with image segmentation (default
5.0)</p></li>
<li><p><strong>pixelmin</strong> (<em>float, optional</em>) – <em>Minimum</em> pixel area of an isophote to be considered a good source for
building the ePSF (default 20)</p></li>
<li><p><strong>etamax</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed elongation for an isophote to be considered a good
source for building the ePSF (default 1.4)</p></li>
<li><p><strong>areamax</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed area (in square pixels) for an isophote to be
considered a good source for building the ePSF (default 500)</p></li>
<li><p><strong>cutout</strong> (<em>int, optional</em>) – Cutout size around each star in pixels (default 35; must be <strong>odd</strong>;
rounded <strong>down</strong> if even)</p></li>
<li><p><strong>psf_fwhm_max</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed ePSF FWHM in pixels such that function will exit if
the FWHM exceeds this value (default 7.0)</p></li>
<li><p><strong>kernel</strong> (<em>{“gauss”, “moffat”}, optional</em>) – Type of kernel to fit to the ePSF, where this kernel will then be
convolved with the input image (default “gauss”)</p></li>
<li><p><strong>alpha</strong> (<em>float, optional</em>) – Alpha parameter (power) for te Moffat kernel (default 1.5)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Whether to write the newly-convolved image to a new fits file (default
True)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for the output convolved image (default
<cite>image_file.replace(“.fits”, “_selfconv.fits”)</cite>)</p></li>
<li><p><strong>plot</strong> (<em>bool, optional</em>) – Whether to plot the newly-convolved image (default False)</p></li>
<li><p><strong>output_plot</strong> (<em>str, optional</em>) – Name for the output figure (default
<cite>image_file.replace(“.fits”, “_selfconv.png”)</cite>)</p></li>
<li><p><strong>verbose</strong> (<em>bool, optional</em>) – Whether to be verbose (default True)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Fits HDU for the newly-convolved image</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.io.fits.PrimaryHDU</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Finds the ePSF of the input image and finds the FWHM (and thus sigma) of
the ePSF. Then builds a Gaussian with this sigma and convolves the input
image with the Gaussian, <strong>or</strong> builds a Moffat distribution with half the
ePSF FWHM as the core width and convolves the image with the Moffat.</p>
<p>Effectively tries to increase the size of the image’s ePSF by sqrt(2).
Useful as a preparation for image differencing when sigma_template &gt;
sigma_science.</p>
</dd></dl>

</section>
<section id="module-amakihi.imalign">
<span id="amakihi-imalign-module"></span><h2>amakihi.imalign module<a class="headerlink" href="#module-amakihi.imalign" title="Permalink to this heading"></a></h2>
<p>Image alignment, A.K.A. image registration. In all, this is the trickiest part
of image differencing. Poor alignment will result in all sorts of headaches
later, and in particular, the appearance of “dipole”-like artifacts in the
final difference image.</p>
<p><strong>Important:</strong> This module makes use of a slightly modified version of the
<cite>astroalign</cite> software developed by Martin Beroiz and the TOROS Dev Team
(<a class="reference external" href="https://github.com/quatrope/astroalign">https://github.com/quatrope/astroalign</a>) in the form of my own script
<cite>astroalign_mod.py</cite>. I claim absolutely no ownership of this software. All
modifications are described in that script.</p>
<dl class="py function">
<dt class="sig sig-object py" id="amakihi.imalign.image_align_imsegm">
<span class="sig-prename descclassname"><span class="pre">amakihi.imalign.</span></span><span class="sig-name descname"><span class="pre">image_align_imsegm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">science_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sciexclu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmpexclu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sciper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmpper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsources</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixelmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etamax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">doublealign</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sep_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncrossmatch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wcs_transfer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_sources</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">circ_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#fe01b1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_im</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.imalign.image_align_imsegm" title="Permalink to this definition"></a></dt>
<dd><p>Align a science image to a template image, using image segmentation (via
<cite>photutils</cite>) for source extraction and <cite>astroalign</cite> for alignment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>science_file, template_file</strong> (<em>str</em>) – Science and template fits file names</p></li>
<li><p><strong>mask_file</strong> (<em>str, optional</em>) – Mask fits file name (default None)</p></li>
<li><p><strong>sciexclu, tmpexclu</strong> (<em>float, optional</em>) – Fraction of the image edges from which to exclude sources during
matching for the science and template images (default 0.05)</p></li>
<li><p><strong>sciper, tmpper</strong> (<em>float, optional</em>) – Upper flux percentile beyond which to exclude sources (default 0.95)</p></li>
<li><p><strong>nsources</strong> (<em>int, optional</em>) – Maximum number of sources to use in asterism-matching (default 50)</p></li>
<li><p><strong>thresh_sigma</strong> (<em>float or array_like, optional</em>) – Sigma threshold for source detection with image segmentation (default
3.0; can be length-2 array to assign different values for science and
template)</p></li>
<li><p><strong>pixelmin</strong> (<em>float or array_like, optional</em>) – <em>Minimum</em> pixel area of an isophote to be considered a source (default
10; can be length-2 array to assign different values for science and
template)</p></li>
<li><p><strong>etamax</strong> (<em>float or array_like, optional</em>) – <em>Maximum</em> allowed elongation for an isophote to be considered a source
(default 2.0; can be length-2 array to assign different values for
science and template)</p></li>
<li><p><strong>doublealign</strong> (<em>bool, optional</em>) – Whether to perform a second iteration of alignment for fine-tuning (see
notes for details; default False)</p></li>
<li><p><strong>sep_max</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed on-sky separation (in arcsec) to cross-match a source
in the science image to the template during double alignment (default
2.0)</p></li>
<li><p><strong>ncrossmatch</strong> (<em>int, optional</em>) – Required number of cross-matched sources to proceed with double
alignment (default 8)</p></li>
<li><p><strong>wcs_transfer</strong> (<em>bool, optional</em>) – Whether to attempt to transfer WCS coordinates from the template to the
newly-aligned image (default True)</p></li>
<li><p><strong>plot_sources</strong> (<em>bool, optional</em>) – Whether to plot sources detected in the science and template images,
side-by-side, for visual inspection (default False)</p></li>
<li><p><strong>plot_align</strong> (<em>bool, optional</em>) – Whether to plot the final aligned science image (default False)</p></li>
<li><p><strong>scale</strong> (<em>{“linear”, “log”, “asinh”}</em>) – Scale to apply to the plots (default “linear”)</p></li>
<li><p><strong>circ_color</strong> (<em>str, optional</em>) – Color for the circles drawn around detected sources (default “#fe01b1
–&gt; bright pink; only relevant if <cite>plot_sources == True</cite>)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Whether to write <em>both</em> outputs (the aligned image and mask image from
the image registration footprint) (default True)</p></li>
<li><p><strong>output_im</strong> (<em>str, optional</em>) – Name for output aligned image fits file (default
<cite>science_file.replace(“.fits”, “_align.fits”)</cite>)</p></li>
<li><p><strong>output_mask</strong> (<em>str, optional</em>) – Name for output mask fits file (default
<cite>science_file.replace(“.fits”, “_align_mask.fits”)</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>align_hdu</strong> (<em>astropy.io.fits.PrimaryHDU</em>) – New HDU (image + header) of the aligned science image</p></li>
<li><p><strong>mask_hdu</strong> (<em>astropy.io.fits.PrimaryHDU</em>) – New HDU (image + header) of the final mask</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><strong>Uses a slightly modified version of astroalign.</strong></p>
<p>This function does a lot. Step by step:</p>
<ol class="arabic simple">
<li><p>Uses image segmentation to find “control points” (sources) in the
science and template images</p></li>
<li><p>Rejects sources very close to the image edges (limits set by user,
see <cite>sciexclu</cite> and <cite>tmpexclu</cite>)</p></li>
<li><p>Rejects sources below some minimum isophotal area <cite>pixelmin</cite></p></li>
<li><p>Rejects sources with elongation above <cite>etamax</cite></p></li>
<li><p>Rejects sources above some upper flux percentile (set by user, see
<cite>sciper</cite> and <cite>tmpper</cite>)</p></li>
<li><p>Retains at most <cite>nsources</cite> control points</p></li>
<li><p><strong>Control points are passed to astroalign</strong>, which finds invariants
between the source and template control point sets and computes the
affine transformation which aligns the source image to the template
image, and then applies this transformation to the science image</p></li>
<li><p><strong>Optional (if doublealign == True)</strong>: With the newly aligned image
and WCS coordinates in both science and template images, constructs
pairs of sources at the same coordinates, and computes another
transformation which respects these pairs to fine-tune the alignment</p></li>
</ol>
<p><strong>TO-DO:</strong></p>
<ul class="simple">
<li><p>Allow naming of output plots</p></li>
<li><p>Fix: During transfer of WCS header from PS1 to CFHT, WCS becomes nonsense</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.imalign.image_align_astrometry">
<span class="sig-prename descclassname"><span class="pre">amakihi.imalign.</span></span><span class="sig-name descname"><span class="pre">image_align_astrometry</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">science_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sciexclu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmpexclu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sciper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmpper</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.95</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsources</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bkgsubbed</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">astrom_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">8.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psf_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wcs_transfer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_sources</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">circ_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#fe01b1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_im</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.imalign.image_align_astrometry" title="Permalink to this definition"></a></dt>
<dd><p>Align a science image to a template image, using <cite>astrometry.net</cite> for
source extraction and <cite>astroalign</cite> for alignment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>science_file, template_file</strong> (<em>str</em>) – Science and template fits file names</p></li>
<li><p><strong>mask_file</strong> (<em>str, optional</em>) – Mask fits file name (default None)</p></li>
<li><p><strong>sciexclu, tmpexclu</strong> (<em>float, optional</em>) – Fraction of the image edges from which to exclude sources during
matching for the science and template images (default 0.05)</p></li>
<li><p><strong>sciper, tmpper</strong> (<em>float, optional</em>) – Upper flux percentile beyond which to exclude sources (default 0.95)</p></li>
<li><p><strong>nsources</strong> (<em>int, optional</em>) – Maximum number of sources to use in asterism-matching (default 50)</p></li>
<li><p><strong>bkgsubbed</strong> (<em>bool or array_like, optional</em>) – Whether the images have already been background-subtracted (default
False; can be length-2 array to assign different bools for science
and template)</p></li>
<li><p><strong>astrom_sigma</strong> (<em>float or array_like, optional</em>) – Detection significance when using <cite>image2xy</cite> in <cite>astrometry.net</cite> to
find sources (default 8.0, can be length-2 array to assign different
values for science and template)</p></li>
<li><p><strong>psf_sigma</strong> (<em>float or array_like, optional</em>) – Sigma of the approximate Gaussian PSF of the images (default 5.0; can
be length-2 array to assign different values for science and template)</p></li>
<li><p><strong>keep</strong> (<em>bool, optional</em>) – Whether to keep the source list files (<cite>.xy.fits</cite> files; default False)</p></li>
<li><p><strong>wcs_transfer</strong> (<em>bool, optional</em>) – Whether to attempt to transfer WCS coordinates from the template to the
newly-aligned image (default True)</p></li>
<li><p><strong>plot_sources</strong> (<em>bool, optional</em>) – Whether to plot sources detected in the science and template images,
side-by-side, for visual inspection (default False)</p></li>
<li><p><strong>plot_align</strong> (<em>bool, optional</em>) – Whether to plot the final aligned science image (default False)</p></li>
<li><p><strong>scale</strong> (<em>{“linear”, “log”, “asinh”}</em>) – Scale to apply to the plots (default “linear”)</p></li>
<li><p><strong>circ_color</strong> (<em>str, optional</em>) – Color for the circles drawn around detected sources (default “#fe01b1
–&gt; bright pink; only relevant if <cite>plot_sources == True</cite>)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Whether to write <em>both</em> outputs (the aligned image and mask image from
the image registration footprint) (default True)</p></li>
<li><p><strong>output_im</strong> (<em>str, optional</em>) – Name for output aligned image fits file (default
<cite>science_file.replace(“.fits”, “_align.fits”)</cite>)</p></li>
<li><p><strong>output_mask</strong> (<em>str, optional</em>) – Name for output mask fits file (default
<cite>science_file.replace(“.fits”, “_align_mask.fits”)</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>align_hdu</strong> (<em>astropy.io.fits.PrimaryHDU</em>) – New HDU (image + header) of the aligned science image</p></li>
<li><p><strong>mask_hdu</strong> (<em>astropy.io.fits.PrimaryHDU</em>) – New HDU (image + header) of the final mask</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><strong>Uses a slightly modified version of astroalign.</strong></p>
<p>This function does a lot. Step by step:</p>
<ol class="arabic simple">
<li><p>Uses <cite>image2xy</cite> of <cite>astrometry.net</cite> to find “control points” (sources)
in the science and template images</p></li>
<li><p>Retains at most <cite>nsources</cite> control points</p></li>
<li><p><strong>Control points are passed to astroalign</strong>, which finds invariants
between the source and template control point sets and computes the
affine transformation which aligns the source image to the template
image, and then applies this transformation to the science image</p></li>
</ol>
<p><strong>Note:</strong> <cite>image2xy</cite> has a hard time doing basic background subtraction
when an image has nans in it. Before trying alignment with an image which
contains nans, it is suggested to set all nans to 0 instead.</p>
<p><strong>TO-DO:</strong></p>
<ul class="simple">
<li><p>Allow naming of output plots</p></li>
<li><p>Fix: During transfer of WCS header from PS1 to CFHT, WCS becomes nonsense</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.imalign.image_align">
<span class="sig-prename descclassname"><span class="pre">amakihi.imalign.</span></span><span class="sig-name descname"><span class="pre">image_align</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">science_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wcs_transfer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_im</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.imalign.image_align" title="Permalink to this definition"></a></dt>
<dd><p>Align a science image to a template image using <cite>astroalign</cite> for <strong>all</strong>
steps, including source extraction and the final alignment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>science_file, template_file</strong> (<em>str</em>) – Science and template fits file names</p></li>
<li><p><strong>mask_file</strong> (<em>str, optional</em>) – Mask fits file name (default None)</p></li>
<li><p><strong>thresh_sigma</strong> (<em>float or array_like, optional</em>) – Sigma threshold for source detection within astroalign (default 3.0)</p></li>
<li><p><strong>wcs_transfer</strong> (<em>bool, optional</em>) – Whether to attempt to transfer WCS coordinates from the template to the
newly-aligned image (default True)</p></li>
<li><p><strong>plot_align</strong> (<em>bool, optional</em>) – Whether to plot the final aligned science image (default False)</p></li>
<li><p><strong>scale</strong> (<em>{“linear”, “log”, “asinh”}</em>) – Scale to apply to the plots (default “linear”)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Whether to write <em>both</em> outputs (the aligned image and mask image from
the image registration footprint) (default True)</p></li>
<li><p><strong>output_im</strong> (<em>str, optional</em>) – Name for output aligned image fits file (default
<cite>science_file.replace(“.fits”, “_align.fits”)</cite>)</p></li>
<li><p><strong>output_mask</strong> (<em>str, optional</em>) – Name for output mask fits file (default
<cite>science_file.replace(“.fits”, “_align_mask.fits”)</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>align_hdu</strong> (<em>astropy.io.fits.PrimaryHDU</em>) – New HDU (image + header) of the aligned science image</p></li>
<li><p><strong>mask_hdu</strong> (<em>astropy.io.fits.PrimaryHDU</em>) – New HDU (image + header) of the final mask</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><strong>Uses a slightly modified version of astroalign.</strong></p>
<p><strong>TO-DO:</strong></p>
<ul class="simple">
<li><p>Allow naming of output plot</p></li>
<li><p>Fix: During transfer of WCS header from PS1 to CFHT, WCS becomes nonsense</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.imalign.image_align_morph">
<span class="sig-prename descclassname"><span class="pre">amakihi.imalign.</span></span><span class="sig-name descname"><span class="pre">image_align_morph</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">science_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">template_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxoffset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">30.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wcs_transfer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_align</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_im</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.imalign.image_align_morph" title="Permalink to this definition"></a></dt>
<dd><p>Align a science image to a template image using <cite>image_registration</cite>,
which relies on image morphology rather than cross-matching control points.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>science_file, template_file</strong> (<em>str</em>) – Science and template fits file names</p></li>
<li><p><strong>mask_file</strong> (<em>str, optional</em>) – Mask fits file name (default None)</p></li>
<li><p><strong>flip</strong> (<em>bool, optional</em>) – Whether to flip the science image before attempting to align it
(default False)</p></li>
<li><p><strong>maxoffset</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed offset between science and template images to
consider the solution a good alignment (default 30.0)</p></li>
<li><p><strong>wcs_transfer</strong> (<em>bool, optional</em>) – Whether to attempt to transfer WCS coordinates from the template to the
newly-aligned image (default True)</p></li>
<li><p><strong>plot_align</strong> (<em>bool, optional</em>) – Whether to plot the final aligned science image (default False)</p></li>
<li><p><strong>scale</strong> (<em>{“linear”, “log”, “asinh”}</em>) – Scale to apply to the plots (default “linear”)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Whether to write <em>both</em> outputs (the aligned image and mask image from
the image registration footprint) (default True)</p></li>
<li><p><strong>output_im</strong> (<em>str, optional</em>) – Name for output aligned image fits file (default
<cite>science_file.replace(“.fits”, “_align.fits”)</cite>)</p></li>
<li><p><strong>output_mask</strong> (<em>str, optional</em>) – Name for output mask fits file (default
<cite>science_file.replace(“.fits”, “_align_mask.fits”)</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>align_hdu</strong> (<em>astropy.io.fits.PrimaryHDU</em>) – New HDU (image + header) of the aligned science image</p></li>
<li><p><strong>mask_hdu</strong> (<em>astropy.io.fits.PrimaryHDU</em>) – New HDU (image + header) of the final mask</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Calls on <cite>image_registration</cite> to align the science image with the target to
allow for proper image differencing. Also finds a mask of out of bounds
pixels to ignore during differencing. The image registration in this
function is based on morphology and edge detection in the image, in
contrast with <cite>image_align_segm()</cite>, <cite>image_align_astrometry()</cite>, and
<cite>image_align()</cite>, which use asterism-matching to align the two images.</p>
<p>For images composed mostly of point sources, use image_align. For images
composed mainly of galaxies/nebulae and/or other extended objects, use this
function.</p>
<p><strong>TO-DO:</strong></p>
<ul class="simple">
<li><p>Fix: WCS header of aligned image doesn’t always seem correct for alignment
with non-CFHT templates</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.imalign.solve_field">
<span class="sig-prename descclassname"><span class="pre">amakihi.imalign.</span></span><span class="sig-name descname"><span class="pre">solve_field</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_PC</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verify</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prebkgsub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">guess_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">read_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_tol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.imalign.solve_field" title="Permalink to this definition"></a></dt>
<dd><p>Use the <cite>solve-field</cite> command of <cite>astrometry.net</cite> to find an astrometric
solution for an image and output an updated, solved fits file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_file</strong> (<em>str</em>) – Filename for fits image to solve with <cite>astrometry.net</cite>’s
<cite>solve-field</cite></p></li>
<li><p><strong>remove_PC</strong> (<em>bool, optional</em>) – Whether to look for “PC00i00j” headers and remove them before solving,
if present (default True)</p></li>
<li><p><strong>verify</strong> (<em>bool, optional</em>) – Whether to try and verify existing WCS headers when solving (default
False)</p></li>
<li><p><strong>prebkgsub</strong> (<em>bool, optional</em>) – Whether the input image has already been background-subtracted (default
False)</p></li>
<li><p><strong>guess_scale</strong> (<em>bool, optional</em>) – Whether to try and guess the scale of the image from WCS headers
(default False)</p></li>
<li><p><strong>read_scale</strong> (<em>bool, optional</em>) – Whether to instead search for a “PIXSCAL1” header containing the image
pixel scale (default True; ignored if <cite>guess_scale == True</cite>)</p></li>
<li><p><strong>pixscale</strong> (<em>float, optional</em>) – Image scale in arcsec per pixel, if known (default None; will be
ignored if <cite>guess_scale == True</cite> <em>OR</em> if <cite>read_scale == True</cite> and the
“PIXSCAL1” header is successfully found)</p></li>
<li><p><strong>scale_tol</strong> (<em>float, optional</em>) – Degree of +/- tolerance for the pixel scale of the image (in arcsec per
pix), if the header “PIXSCAL1” is found <em>or</em> if a scale is given
(default 0.05; see notes for details)</p></li>
<li><p><strong>verbose</strong> (<em>{0, 1, 2}, optional</em>) – Level of verbosity (default 0)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output updated .fits file (default
<cite>image_file.replace(“.fits”,”_solved.fits”)</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The STDOUT produced by <cite>astrometry.net</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the output filename and input filename are the same</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If hdr[“PIXSCAL1”] = 0.185 and <cite>scale_tol = 0.05</cite>, <cite>solve-field</cite> will only
look for solutions with a pixel scale of 0.185 +/- 0.05 arcsec per pix.</p>
<p><strong>Note:</strong> Output filename must be different from input filename.</p>
</dd></dl>

</section>
<section id="module-amakihi.masking">
<span id="amakihi-masking-module"></span><h2>amakihi.masking module<a class="headerlink" href="#module-amakihi.masking" title="Permalink to this heading"></a></h2>
<p>Constructing masks.</p>
<dl class="py function">
<dt class="sig sig-object py" id="amakihi.masking.box_mask">
<span class="sig-prename descclassname"><span class="pre">amakihi.masking.</span></span><span class="sig-name descname"><span class="pre">box_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixy</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.masking.box_mask" title="Permalink to this definition"></a></dt>
<dd><p>Create a simple box-shaped mask delimited by input pixel coordinates,
optionally combined with an existing mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_file</strong> (<em>str</em>) – Image (fits) filename</p></li>
<li><p><strong>pixx, pixy</strong> (<em>tuple</em>) – x-pixel pair and y-pixel pair denoting the bounds of the box to build</p></li>
<li><p><strong>mask_file</strong> (<em>str, optional</em>) – Existing mask image (fits) filename to combine existing mask with new
boxmask (default None)</p></li>
<li><p><strong>plot</strong> (<em>bool, optional</em>) – Whether to plot the mask (default False)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Whether to write the new mask to a fits file</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output fits file (default
<cite>image_file.replace(“.fits”, “_boxmask.fits”)</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>New HDU (image + header) for the mask (<strong>not</strong> the masked data)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.io.fits.PrimaryHDU</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.masking.saturation_mask">
<span class="sig-prename descclassname"><span class="pre">amakihi.masking.</span></span><span class="sig-name descname"><span class="pre">saturation_mask</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">image_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sat_ADU</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">40000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sat_area_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra_safe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec_safe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rad_safe</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dilation_its</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">blur_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.masking.saturation_mask" title="Permalink to this definition"></a></dt>
<dd><p>Produce a mask of all saturated sources in an image, optionally combined
with an existing mask.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image_file</strong> (<em>str</em>) – Image (fits) filename</p></li>
<li><p><strong>mask_file</strong> (<em>str, optional</em>) – Existing mask image (fits) filename to combine existing mask with new
saturation mask (default None)</p></li>
<li><p><strong>sat_ADU</strong> (<em>float, optional</em>) – ADU value above which a pixel is considered saturated (default 40000,
which is a bit below the limit for MegaCam)</p></li>
<li><p><strong>sat_area_min</strong> (<em>float, optional</em>) – <em>Minimum</em> pixel area for a source to be considered a saturated source
(default 500)</p></li>
<li><p><strong>ra_safe, dec_safe</strong> (<em>float, optional</em>) – Right Ascension and Declination (in decimal degrees) at the centre of a
“safe zone” in which sources will not be masked (default None), see
<cite>rad_safe</cite></p></li>
<li><p><strong>rad_safe</strong> (<em>float, optional</em>) – Radius (in arcsec) of the “safe zone”, a circle centered on
(<cite>ra_safe</cite>, <cite>dec_safe</cite>) (default None)</p></li>
<li><p><strong>dilation_its</strong> (<em>int, optional</em>) – Number of iterations of binary dilation to apply to the mask (see
notes for details; default 5; can be set to 0 turn this off)</p></li>
<li><p><strong>blur_sigma</strong> (<em>float, optional</em>) – Sigma of the Gaussian filter to apply to the mask to blur it (default
2.0; can be set to 0 to turn this off)</p></li>
<li><p><strong>plot</strong> (<em>bool, optional</em>) – Whether to plot the new saturation mask (default True)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Whether to write the new mask to a fits file (default True)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output fits file (default
<cite>image_file.replace(“.fits”, “_satmask.fits”)</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>tbl</strong> (<em>astropy.table.table.Table</em>) – A table containing properties of the sources which were flagged as
saturated</p></li>
<li><p><strong>mask_hdu</strong> (<em>astropy.io.fits.PrimaryHDU</em>) – New HDU (image + header) for the mask (<strong>not</strong> the masked data)</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Uses image segmentation to find all sources in the image. Then, looks for
sources which have a maximum flux above the saturation ADU and above the
minimum saturation area and creates a mask of these sources.</p>
<p>Binary dilation is applied to to “dilate” (i.e., enlarge) features in the
mask, and Gaussian blurring is applied, to smooth out the mask and ensure
that saturated sources are completely masked. Binary dilation is very
helpful for catching diffraction spikes which are initially not completely
masked. <strong>Note</strong> however that both binary dilation and Gaussian blurring
can be disabled by setting <cite>dilation_its = 0</cite> and <cite>blur_sigma = 0</cite>,
respectively.</p>
<p>If a “safe zone” is supplied, any sources within the safe zone will be
labelled as NON-saturated. This is useful if you know the coordinates of
some galaxy/nebulosity in your image which should not be masked, as it is
sometimes difficult to distinguish between a saturated source and a galaxy.</p>
<p>If an existing mask is supplied, the output mask will be a combination of
the previous mask and saturation mask.</p>
</dd></dl>

</section>
<section id="module-amakihi.plotting">
<span id="amakihi-plotting-module"></span><h2>amakihi.plotting module<a class="headerlink" href="#module-amakihi.plotting" title="Permalink to this heading"></a></h2>
<p>Functions for plotting images, triplets, etc.</p>
<p>Also contains several functions for plotting machine learning diagnostics.</p>
<p>See the source code for utility plotting functions called by:</p>
<ul class="simple">
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">background</span></code> module</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">masking</span></code> module</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">imalign</span></code> module</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ePSF</span></code> module</p></li>
<li><p><a class="reference internal" href="#module-amakihi" title="amakihi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">amakihi</span></code></a> (image differencing) module</p></li>
<li><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">transient</span></code> module</p></li>
</ul>
<dl class="py function">
<dt class="sig sig-object py" id="amakihi.plotting.to_agg">
<span class="sig-prename descclassname"><span class="pre">amakihi.plotting.</span></span><span class="sig-name descname"><span class="pre">to_agg</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.plotting.to_agg" title="Permalink to this definition"></a></dt>
<dd><p>Switch matplotlib backend to ‘agg’</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.plotting.to_Qt4Agg">
<span class="sig-prename descclassname"><span class="pre">amakihi.plotting.</span></span><span class="sig-name descname"><span class="pre">to_Qt4Agg</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.plotting.to_Qt4Agg" title="Permalink to this definition"></a></dt>
<dd><p>Switch matplotlib backend to ‘Qt4Agg’</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.plotting.plot_image">
<span class="sig-prename descclassname"><span class="pre">amakihi.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_image</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bone'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_large</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_small</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crosshair_large</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'black'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crosshair_small</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#fe019a'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.plotting.plot_image" title="Permalink to this definition"></a></dt>
<dd><p>Plot an image of any kind, with lots of options.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im_file</strong> (<em>str</em>) – Filename for fits image of interest</p></li>
<li><p><strong>mask_file</strong> (<em>str, optional</em>) – Filename for mask fits image (default None)</p></li>
<li><p><strong>scale</strong> (<em>{“linear”, “log”, “asinh”}, optional</em>) – Scale to use for the image (default “linear”)</p></li>
<li><p><strong>cmap</strong> (<em>str, matplotlib.colors.ListedColormap, optional</em>) – Colourmap to use for the image (default “bone”)</p></li>
<li><p><strong>label</strong> (<em>str, optional</em>) – Label to apply to the colorbar (default None, in which case will be
ADU, log(ADU), or asinh(ADU) depending on <cite>scale</cite>)</p></li>
<li><p><strong>title</strong> (<em>str, optional</em>) – Title for the image (default None)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output figure (default
<cite>im_file.replace(“.fits”, f”_{scale}.png”)</cite>)</p></li>
<li><p><strong>target_large</strong> (<em>array_like, optional</em>) – [ra, dec] for a target at which to place a large crosshair (default
None)</p></li>
<li><p><strong>target_small</strong> (<em>array_like, optional</em>) – [ra, dec] for a target at which to place a small crosshair (default
None)</p></li>
<li><p><strong>crosshair_large</strong> (<em>str, optional</em>) – Color for the large crosshair (default “black”)</p></li>
<li><p><strong>crosshair_small</strong> (<em>str, optional</em>) – Color for the small crosshair (default “#fe019a” –&gt; ~ hot pink)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.plotting.plot_transient_stamp">
<span class="sig-prename descclassname"><span class="pre">amakihi.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_transient_stamp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cropmode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'truncate'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'asinh'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bone'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crosshair</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#fe019a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.plotting.plot_transient_stamp" title="Permalink to this definition"></a></dt>
<dd><p>Plot a “postage stamp” around a transient source of interest, where the
input image can be the science, reference, difference, or whatever image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im_file</strong> (<em>str</em>) – Filename for fits image of interest</p></li>
<li><p><strong>target</strong> (<em>array_like</em>) – [ra, dec] of transient source of interest</p></li>
<li><p><strong>size</strong> (<em>float, optional</em>) – Pixel size of the box to crop around the transient (default 200.0)</p></li>
<li><p><strong>cropmode</strong> (<em>{“truncate”, “extend”}</em>) – Mode to use for <cite>crop_WCS()</cite> (when cropping to select the transient) if
the crop goes out of bounds (default “truncate”)</p></li>
<li><p><strong>scale</strong> (<em>{“linear”, “log”, “asinh”}, optional</em>) – Scale to use for the image (default “linear”)</p></li>
<li><p><strong>cmap</strong> (<em>str, matplotlib.colors.ListedColormap, optional</em>) – Colourmap to use for the image (default “bone”)</p></li>
<li><p><strong>crosshair</strong> (<em>str, optional</em>) – Color for the crosshair(s) (default “#fe019a” –&gt; ~ hot pink)</p></li>
<li><p><strong>label</strong> (<em>str, optional</em>) – Label to apply to the colorbar (default None, in which case will be
ADU, log(ADU), or asinh(ADU) depending on <cite>scale</cite>)</p></li>
<li><p><strong>title</strong> (<em>str, optional</em>) – Title for the image (default None)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output figure (default
<cite>im_file.replace(“.fits”, f”_{scale}.png”)</cite>)</p></li>
<li><p><strong>toi</strong> (<em>array_like, optional</em>) – [ra, dec] of some other source of interest such as a candidate host
galaxy for the transient such that another crosshair is plotted at its
location (default None)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.plotting.plot_transient">
<span class="sig-prename descclassname"><span class="pre">amakihi.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_transient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sub_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">og_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tbl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixcoords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['zoom</span> <span class="pre">og',</span> <span class="pre">'zoom</span> <span class="pre">ref',</span> <span class="pre">'zoom</span> <span class="pre">diff']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'asinh'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">og_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'asinh'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stampsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crosshair_og</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#fe019a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crosshair_sub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#5d06e9'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.plotting.plot_transient" title="Permalink to this definition"></a></dt>
<dd><p>Plot a candidate transient source, with tons of options.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sub_file</strong> (<em>str</em>) – Difference image fits filename</p></li>
<li><p><strong>og_file</strong> (<em>str</em>) – Original science image fits filename (does not need to be background-
subtracted)</p></li>
<li><p><strong>ref_file</strong> (<em>str</em>) – Reference image fits filename (does not need to be background-
subtracted)</p></li>
<li><p><strong>tbl</strong> (<em>str or astropy.table.Table</em>) – Table of candidate transient source(s) found with <cite>transient_detect()</cite>
or some other tool (can be a filename or the table itself)</p></li>
<li><p><strong>pixcoords</strong> (<em>bool, optional</em>) – Whether to use the <em>pixel</em> coordinates of the transient(s) when
plotting rather than the WCS coordinates (default False; see notes)</p></li>
<li><p><strong>toi</strong> (<em>array_like, optional</em>) – [ra, dec] of some other source of interest such as a candidate host
galaxy for the transient such that another crosshair is plotted at its
location (default None)</p></li>
<li><p><strong>plots</strong> (<em>array_like, optional</em>) – Array indicating which plots to produce, where options are “full”,
“zoom og”, “zoom ref”, “zoom diff” (default
[“zoom og”, “zoom ref”, “zoom diff”]; see notes)</p></li>
<li><p><strong>sub_scale</strong> (<em>{“asinh”, “linear”, “log”}, optional</em>) – Scale to use for the difference image (default “asinh”)</p></li>
<li><p><strong>og_scale</strong> (<em>{“asinh”, “linear”, “log”}, optional</em>) – Scale to use for the science/reference images (default “asinh”)</p></li>
<li><p><strong>stampsize</strong> (<em>float, optional</em>) – Pixel size of the box to crop around the transient(s) (default 200.0)</p></li>
<li><p><strong>crosshair_og</strong> (<em>str, optional</em>) – Color for the crosshair in the science/reference image (default
“#fe019a” –&gt; ~ hot pink)</p></li>
<li><p><strong>crosshair_sub</strong> (<em>str, optional</em>) – Color for the crosshair in the difference image (default
“#5d06e9” –&gt; ~ purple-blue)</p></li>
<li><p><strong>title_append</strong> (<em>str, optional</em>) – A “title” to include in all plots’ titles <strong>and</strong> the filenames of all
saved figures (default None)</p></li>
<li><p><strong>plotdir</strong> (<em>str, optional</em>) – Name of directory in which to save plots (default None, in which case
the stamps will be saved in the directory containing the corresponding
fits image)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If <cite>pixcoords == False</cite>, <cite>tbl</cite> must contain <em>at least</em> the columns <em>ra</em> and
<em>dec</em>. If true, must contain <em>at least</em> the columns <em>xcentroid</em> and
<em>ycentroid</em>. It is recommended to use the pixel coordinates (i.e. set
<cite>pixcoords = True</cite>) when the quality of the astrometric solution for the
science or reference images cannot be assured.</p>
<p>When indicating which plots to produce via the <cite>plots</cite> argument (an
<cite>array_like</cite>), the options are:</p>
<ol class="arabic simple">
<li><p>“full” - the full-frame subtracted image</p></li>
<li><p>“zoom og” - postage stamp of the original science image</p></li>
<li><p>“zoom ref” - postage stamp of the original reference image</p></li>
<li><p>“zoom diff” - postage stamp of the subtracted image</p></li>
</ol>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.plotting.plot_triplets">
<span class="sig-prename descclassname"><span class="pre">amakihi.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_triplets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tripfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tabfile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">images</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wide</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">SRDlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">titles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ticks_axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scalebar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.185</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crosshair_from_table</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crosshair_peak</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crosshair_color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#fe01b1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crosshair_thick</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bone'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'png'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.plotting.plot_triplets" title="Permalink to this definition"></a></dt>
<dd><p>Plot a set of triplets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tripfile</strong> (<em>str</em>) – .npy file containing triplets</p></li>
<li><p><strong>outdir</strong> (<em>str</em>) – Directory in which to store output plots</p></li>
<li><p><strong>tabfile</strong> (<em>str, optional</em>) – Table of candidate transients corresponding to <cite>tripfile</cite> (must be a
.csv or .fits file) (default None)</p></li>
<li><p><strong>images</strong> (<em>list, optional</em>) – <strong>List</strong> of .fits images from which to extract WCS information for
plotting, <strong>if</strong> <cite>tabfile</cite> was provided (default None –&gt; use pixel
coordinates)</p></li>
<li><p><strong>wide</strong> (<em>bool, optional</em>) – Plot the triplets as 3 columns, 1 row (horizontally wide)? Else, plot
as 3 rows, 1 column (vertically tall) (default True)</p></li>
<li><p><strong>SRDlabel</strong> (<em>bool, optional</em>) – Label the science, reference, and difference images with ‘science’,
‘reference’, ‘difference’? (default False)</p></li>
<li><p><strong>titles</strong> (<em>list, optional</em>) – <strong>List</strong> of titles to include in corresponding plots; also used for
setting output filenames (default None)</p></li>
<li><p><strong>ticks_axes</strong> (<em>bool, optional</em>) – Include ticks, tick labels, and axis labels? (default True)</p></li>
<li><p><strong>scalebar</strong> (<em>bool, optional</em>) – Include a bar showing the scale? (default True)</p></li>
<li><p><strong>pixscale</strong> (<em>float, optional</em>) – Pixel scale of the image in arcseconds per pixel; only relevant if
<cite>scalebar = True</cite> (default 0.185 = pixel scale for MegaCam)</p></li>
<li><p><strong>crosshair_from_table</strong> (<em>bool, optional</em>) – Label the science, reference, and difference images with a crosshair
using the location of the source given via <cite>images</cite> and <cite>tabfile</cite>?
(default False)</p></li>
<li><p><strong>crosshair_peak</strong> (<em>bool, optional</em>) – Label the science, reference, and difference images with a crosshair
using the peak of the image? (default False)</p></li>
<li><p><strong>crosshair_color</strong> (<em>str, optional</em>) – Color for crosshair (default “#fe01b1” = bright pink)</p></li>
<li><p><strong>crosshair_thick</strong> (<em>float, optional</em>) – Thickness of crosshairs (default 2.5)</p></li>
<li><p><strong>cmap</strong> (<em>str, matplotlib.colors.ListedColormap, optional</em>) – Colormap to use in plots (default “bone”)</p></li>
<li><p><strong>fmt</strong> (<em>{“png”, “pdf”}, optional</em>) – Filetype for the plots (default “png”)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.plotting.histogram_elongation">
<span class="sig-prename descclassname"><span class="pre">amakihi.plotting.</span></span><span class="sig-name descname"><span class="pre">histogram_elongation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.plotting.histogram_elongation" title="Permalink to this definition"></a></dt>
<dd><p>Plot a histogram of the elongations for sources generated by transient
detection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabfile</strong> (<em>str</em>) – Table of candidate transients (must be a .csv or .fits file)</p></li>
<li><p><strong>title</strong> (<em>str, optional</em>) – Title for output plot (default None)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Filename for output figure (default set by function)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.plotting.histogram_area">
<span class="sig-prename descclassname"><span class="pre">amakihi.plotting.</span></span><span class="sig-name descname"><span class="pre">histogram_area</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.plotting.histogram_area" title="Permalink to this definition"></a></dt>
<dd><p>Plot a histogram of the area for sources generated by transient
detection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabfile</strong> (<em>str</em>) – Table of candidate transients (must be a .csv or .fits file)</p></li>
<li><p><strong>title</strong> (<em>str, optional</em>) – Title for output plot (default None)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Filename for output figure (default set by function)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.plotting.plot_train_vs_valid_accuracy">
<span class="sig-prename descclassname"><span class="pre">amakihi.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_train_vs_valid_accuracy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_acc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_acc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(20,</span> <span class="pre">9)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.plotting.plot_train_vs_valid_accuracy" title="Permalink to this definition"></a></dt>
<dd><p>Plot the training and validation set <strong>accuracy</strong> over the course of
training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_acc</strong> (<em>array_like</em>) – Training set accuracy as a function of epoch</p></li>
<li><p><strong>val_acc</strong> (<em>array_like</em>) – Validation set accuracy as a function of epoch</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output figure (defualt set by function)</p></li>
<li><p><strong>figsize</strong> (<em>tuple, optional</em>) – Figure dimensions, in inches (default (20,9))</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.plotting.plot_train_vs_valid_loss">
<span class="sig-prename descclassname"><span class="pre">amakihi.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_train_vs_valid_loss</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">train_loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">val_loss</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(20,</span> <span class="pre">9)</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.plotting.plot_train_vs_valid_loss" title="Permalink to this definition"></a></dt>
<dd><p>Plot the training and validation set <strong>loss</strong> over the course of
training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>train_loss</strong> (<em>array_like</em>) – Training set loss as a function of epoch</p></li>
<li><p><strong>val_loss</strong> (<em>array_like</em>) – Validation set loss as a function of epoch</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output figure (defualt set by function)</p></li>
<li><p><strong>figsize</strong> (<em>tuple, optional</em>) – Figure dimensions, in inches (default (20,9))</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.plotting.plot_confusion_matrix">
<span class="sig-prename descclassname"><span class="pre">amakihi.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_confusion_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">label_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_pred</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">classes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['bogus',</span> <span class="pre">'real']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Purples'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.plotting.plot_confusion_matrix" title="Permalink to this definition"></a></dt>
<dd><p>Plot the confusion matrix given some true labels and predicted labels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label_true</strong> (<em>array_like</em>) – <strong>Flattened</strong> array of the ground truth labels (0 for bogus, 1 for
real) for a test set</p></li>
<li><p><strong>label_pred</strong> (<em>np.ndarray</em>) – Array of <strong>predicted</strong> labels for a test set, as returned by some
classifier</p></li>
<li><p><strong>normalize</strong> (<em>bool, optional</em>) – Return percentages? or return actual numbers (default True)</p></li>
<li><p><strong>classes</strong> (<em>array_like, optional</em>) – Array / tuple with the names the classes
(default [“bogus”, “real”], which assigns “bogus” to 0 and “real” to
1)</p></li>
<li><p><strong>cmap</strong> (<em>str, matplotlib.colors.ListedColormap, optional</em>) – Colormap for the plot (default “Purples”)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output figure (default set by function)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Confusion matrix ((2,2) array)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>E.g., if <cite>label_true</cite> has shape <cite>(100,)</cite>, <cite>label_pred</cite> must have shape
<cite>(100,1)</cite></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.plotting.plot_FPR_FNR_RBscore">
<span class="sig-prename descclassname"><span class="pre">amakihi.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_FPR_FNR_RBscore</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bool_bogus_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bool_real_true</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0.5]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.plotting.plot_FPR_FNR_RBscore" title="Permalink to this definition"></a></dt>
<dd><p>Plot the False Positive Rate (FPR) and False Negative Rate (FNR) of
some predictions given some RB score threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>preds</strong> (<em>array_like</em>) – Predicted element for each element in the test set</p></li>
<li><p><strong>bool_bogus_true</strong> (<em>array_like</em>) – Array where True if ground truth is <strong>bogus</strong>, for each element in the
test set</p></li>
<li><p><strong>bool_real_true</strong> (<em>array_like</em>) – Array where True if ground truth is <strong>real</strong>, for each element in the
test set</p></li>
<li><p><strong>thresholds</strong> (<em>array_like</em>) – Array of thresholds for which the FPR and FNR will be annotated
(default [0.5]; can be set to None to be disabled)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output figure (default set by function)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.plotting.plot_ROC">
<span class="sig-prename descclassname"><span class="pre">amakihi.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_ROC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">preds</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.plotting.plot_ROC" title="Permalink to this definition"></a></dt>
<dd><p>Plot the receiver operating characteristic (ROC) curve, for some test
data set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>test_labels</strong> (<em>array_like</em>) – Array of labels (0 or 1) given to sources in the test set, for some
RB score threshold</p></li>
<li><p><strong>preds</strong> (<em>array_like</em>) – Array of <strong>predicted</strong> RB scores given some threshold</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output figure (default set by function)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The ROC curve shows the False Positive Rate (FPR; Contamination) versus
the True Positive Rate (TPR; Sensitivity). Shows the entire plot as well
as a zoomed-in section near where (ideally) FPR~0, TPR~1.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.plotting.plot_histogram_RB_score">
<span class="sig-prename descclassname"><span class="pre">amakihi.plotting.</span></span><span class="sig-name descname"><span class="pre">plot_histogram_RB_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'label_preds'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rb_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.plotting.plot_histogram_RB_score" title="Permalink to this definition"></a></dt>
<dd><p>Plot a histogram showing the RB scores predicted by some model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabfile</strong> (<em>str</em>) – Table of candidate transients which have been assigned an RB score by
some model, or have been manually labelled (must be a .csv or .fits
file)</p></li>
<li><p><strong>key</strong> (<em>str, optional</em>) – Key (column name) to use to extract the predicted RB score (default
“label_preds”)</p></li>
<li><p><strong>rb_thresh</strong> (<em>float, optional</em>) – RB score to set as the threshold for real sources (default 0.5)</p></li>
<li><p><strong>title</strong> (<em>str, optional</em>) – Title for the plot (default None)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for the output figure (default set by function)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-amakihi.query_2MASS">
<span id="amakihi-query-2mass-module"></span><h2>amakihi.query_2MASS module<a class="headerlink" href="#module-amakihi.query_2MASS" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="amakihi.query_2MASS.geturl_2MASS">
<span class="sig-prename descclassname"><span class="pre">amakihi.query_2MASS.</span></span><span class="sig-name descname"><span class="pre">geturl_2MASS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'A'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.query_2MASS.geturl_2MASS" title="Permalink to this definition"></a></dt>
<dd><p>Get the URL(s) for some reference image(s) to download from the 2-Micron
All Sky Survey (2MASS).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – RA and Dec of interest</p></li>
<li><p><strong>size</strong> (<em>float, optional</em>) – Size of the cutout image in pixels (1 pix == 4.0” in 2MASS; default
150)</p></li>
<li><p><strong>bands</strong> (<em>str, optional</em>) – Photometric band(s) of choice (default “A” –&gt; all; options are “A”,
“J”, “H”, “K” - see notes for details)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of URL(s) to download the relevant fits files</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Options for bands are “A” –&gt;  all, <strong>OR</strong> “J” for only J-band, <strong>OR</strong> “H”
for only H-band, <strong>OR</strong> “K” for only K-band. Combinations such as e.g. “JH”
are not allowed.</p>
<p>See: <a class="reference external" href="https://irsa.ipac.caltech.edu/applications/2MASS/IM/docs/siahelp.html">https://irsa.ipac.caltech.edu/applications/2MASS/IM/docs/siahelp.html</a></p>
</dd></dl>

</section>
<section id="module-amakihi.query_CFIS">
<span id="amakihi-query-cfis-module"></span><h2>amakihi.query_CFIS module<a class="headerlink" href="#module-amakihi.query_CFIS" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="amakihi.query_CFIS.geturl_CFIS">
<span class="sig-prename descclassname"><span class="pre">amakihi.query_CFIS.</span></span><span class="sig-name descname"><span class="pre">geturl_CFIS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1600</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ur'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.query_CFIS.geturl_CFIS" title="Permalink to this definition"></a></dt>
<dd><p>Get the URL(s) for some reference image(s) to download from the Canada-
France Imaging Survey (CFIS).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – RA and Dec of interest</p></li>
<li><p><strong>size</strong> (<em>float, optional</em>) – Size of the cutout image in pixels (1 pix == 0.185” in CFIS; default
1600)</p></li>
<li><p><strong>bands</strong> (<em>str, optional</em>) – Photometric band(s) of choice (default “ur” –&gt; u- and r-band;
options are “u”, “r”, “ur”)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of URL(s) to download the relevant fits files</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>See: <a class="reference external" href="https://www.cadc-ccda.hia-iha.nrc-cnrc.gc.ca/en/community/cfis/csky.html">https://www.cadc-ccda.hia-iha.nrc-cnrc.gc.ca/en/community/cfis/csky.html</a></p>
</dd></dl>

</section>
<section id="module-amakihi.query_DECaLS">
<span id="amakihi-query-decals-module"></span><h2>amakihi.query_DECaLS module<a class="headerlink" href="#module-amakihi.query_DECaLS" title="Permalink to this heading"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="amakihi.query_DECaLS.geturl_DECaLS">
<span class="sig-prename descclassname"><span class="pre">amakihi.query_DECaLS.</span></span><span class="sig-name descname"><span class="pre">geturl_DECaLS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.262</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'grz'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.query_DECaLS.geturl_DECaLS" title="Permalink to this definition"></a></dt>
<dd><p>Get the URL(s) for some reference image(s) to download from the Dark
Energy Camera Legacy Survey (DECaLS).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – RA and Dec of interest</p></li>
<li><p><strong>size</strong> (<em>int, optional</em>) – Size of the cutout image in pixels (1 pix == 0.262” in native DECam
resolution, but pixel scale can be changed; default 512)</p></li>
<li><p><strong>pixscale</strong> (<em>float, optional</em>) – Pixel scale of the images in arcsec per pixel, (default 0.262”/pix,
which is the native DECam resolution)</p></li>
<li><p><strong>bands</strong> (<em>str, optional</em>) – Photometric band(s) of choice (default “grz” –&gt; g-, r-, and z-band;
options are “g”, “r”, “z”, or any combination of them)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of URL(s) to download the relevant fits files <strong>OR</strong> a single str
if only one URL</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list or str</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>See: <a class="reference external" href="https://www.legacysurvey.org/dr8/files/#image-stacks-region-coadd">https://www.legacysurvey.org/dr8/files/#image-stacks-region-coadd</a></p>
</dd></dl>

</section>
<section id="module-amakihi.query_PS1">
<span id="amakihi-query-ps1-module"></span><h2>amakihi.query_PS1 module<a class="headerlink" href="#module-amakihi.query_PS1" title="Permalink to this heading"></a></h2>
<p><strong>NOTE</strong>: Adapted from <a class="reference external" href="https://ps1images.stsci.edu/ps1image.html">https://ps1images.stsci.edu/ps1image.html</a></p>
<dl class="py function">
<dt class="sig sig-object py" id="amakihi.query_PS1.getimages_PS1">
<span class="sig-prename descclassname"><span class="pre">amakihi.query_PS1.</span></span><span class="sig-name descname"><span class="pre">getimages_PS1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'grizy'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.query_PS1.getimages_PS1" title="Permalink to this definition"></a></dt>
<dd><p>Query the online ps1filenames.py service, which can provide a “table” of
URL(s) for some reference image(s) to download from the Panoramic Survey
Telescope and Rapid Response System (Pan-STARRS) archive (specifically,
the Pan-STARRS 1 (PS1) <span class="math notranslate nohighlight">\(3\pi\)</span> survey).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – RA and Dec of interest</p></li>
<li><p><strong>size</strong> (<em>int, optional</em>) – Size of the cutout image in pixels (1 pix == 0.25” in PS1; default
2400)</p></li>
<li><p><strong>bands</strong> (<em>str, optional</em>) – Photometric band(s) of choice (default “grizy” –&gt; g-, r-, i-, z-, and
y-band; options are “g”, “r”, “i”, “z”, “y” or any combination of them)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of URL(s) to download the relevant fits files <strong>OR</strong> a single str
if only one URL</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list or str</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>See: <a class="reference external" href="http://ps1images.stsci.edu/cgi-bin/ps1cutouts">http://ps1images.stsci.edu/cgi-bin/ps1cutouts</a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.query_PS1.geturl_PS1">
<span class="sig-prename descclassname"><span class="pre">amakihi.query_PS1.</span></span><span class="sig-name descname"><span class="pre">geturl_PS1</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'grizy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'jpg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.query_PS1.geturl_PS1" title="Permalink to this definition"></a></dt>
<dd><p>Get URL(s) for file(s) in the “table” produced by <cite>getimages_PS1()</cite>, and
get URL(s) to download reference image(s) from the Panoramic Survey
Telescope and Rapid Response System (Pan-STARRS) archive (specifically,
the Pan-STARRS 1 (PS1) <span class="math notranslate nohighlight">\(3\pi\)</span> survey).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – RA and Dec of interest</p></li>
<li><p><strong>size</strong> (<em>int, optional</em>) – Size of the cutout image in pixels (1 pix == 0.25” in PS1; default
2400)</p></li>
<li><p><strong>output_size</strong> (<em>int, optional</em>) – Size of the output image, <em>only relevant if requesting a jpg or png</em>
(default is <cite>output_size = size</cite>)</p></li>
<li><p><strong>bands</strong> (<em>str, optional</em>) – Photometric band(s) of choice (default “grizy” –&gt; g-, r-, i-, z-, and
y-band; options are “g”, “r”, “i”, “z”, “y” or any combination of them)</p></li>
<li><p><strong>fmt</strong> (<em>{“jpg”, “png”, “fits”}, optional</em>) – Data format (default “jpg”)</p></li>
<li><p><strong>color</strong> (<em>bool, optional</em>) – Whether to create a colour image, <em>only relevant if requesting a jpg or
png</em> (default False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of URL(s) to download the relevant fits files <strong>OR</strong> a single str
if only one URL</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list or str</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>See: <a class="reference external" href="http://ps1images.stsci.edu/cgi-bin/ps1cutouts">http://ps1images.stsci.edu/cgi-bin/ps1cutouts</a></p>
</dd></dl>

</section>
<section id="module-amakihi.rb_dataset_utils">
<span id="amakihi-rb-dataset-utils-module"></span><h2>amakihi.rb_dataset_utils module<a class="headerlink" href="#module-amakihi.rb_dataset_utils" title="Permalink to this heading"></a></h2>
<p>Utility functions for (pre-)processing the tables, triplets, etc. which go
into training the bogus-real adversarial artificial intelligence (braai)
convolutional neural network.</p>
<dl class="py function">
<dt class="sig sig-object py" id="amakihi.rb_dataset_utils.merge_triplets">
<span class="sig-prename descclassname"><span class="pre">amakihi.rb_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">merge_triplets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_trips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.rb_dataset_utils.merge_triplets" title="Permalink to this definition"></a></dt>
<dd><p>Search a directory for .npy files containing triplets and merge into
one large array, for use in preparing a training set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>direc</strong> (<em>str</em>) – Directory full of .npy files</p></li>
<li><p><strong>filt</strong> (<em>str, optional</em>) – String filter to use when searching for files by name (default None;
e.g., “2019”)</p></li>
<li><p><strong>output_trips</strong> (<em>str, optional</em>) – Name for output file (default None –&gt; do not write)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of merged triplets</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For a directory containing N .npy triplet files, each with shape
<cite>(t_i, 3, Y, X)</cite>, combines them into a single merged ndarray with shape
<cite>(sum(t_i) i=1…N, 3, Y, X)</cite></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.rb_dataset_utils.merge_tables">
<span class="sig-prename descclassname"><span class="pre">amakihi.rb_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">merge_tables</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">direc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.fits'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">cols</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.rb_dataset_utils.merge_tables" title="Permalink to this definition"></a></dt>
<dd><p>Search a directory for tables of candidate transients generated using
<cite>amakihi</cite> and merge into one large table, for use in preparing a training
set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>direc</strong> (<em>str</em>) – Directory containing tables</p></li>
<li><p><strong>filext</strong> (<em>{“.fits”, “.csv”}, optional</em>) – File extension to search for (“.csv” or “.fits”, default “.fits”)</p></li>
<li><p><strong>filt</strong> (<em>str, optional</em>) – String filter to use when searching for files by name (default None;
e.g., “2019”)</p></li>
<li><p><strong>output_tab</strong> (<em>str, optional</em>) – Name for output file (default None –&gt; do not write)</p></li>
<li><p><strong>*cols</strong> (<em>strs, optional</em>) – Names of columns to use from the input tables</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Merged table</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.table.Table</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For a directory of N astropy tables of transient candidates in the .fits
<strong>or</strong> .csv format, each with <cite>r_i</cite> rows, merges them into a single table
with <cite>sum(r_i) i=1…N</cite> rows.</p>
<p>Currently does not allow for merging tables with different columns.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.rb_dataset_utils.merge_catalogs">
<span class="sig-prename descclassname"><span class="pre">amakihi.rb_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">merge_catalogs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">catalogs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.rb_dataset_utils.merge_catalogs" title="Permalink to this definition"></a></dt>
<dd><p>Merge catalogs/tables, looking only for the essential columns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*catalogs</strong> (<em>str</em>) – Filenames for as many catalogs (tables of sources; must be .fits or
.csv files) with (at minimum) columns giving the RA, Dec, and a name</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Filename for output table (default set by function)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Merged table</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.table.Table</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Valid keys for the RA are: ‘ra’, ‘RA’, ‘RAJ2000’; valid keys for the
Declination are ‘dec’, ‘Dec’, ‘DEJ2000’. Must have a <cite>Name</cite> column.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.rb_dataset_utils.augment_dataset">
<span class="sig-prename descclassname"><span class="pre">amakihi.rb_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">augment_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tab_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">triplet_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">cols</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.rb_dataset_utils.augment_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Augment a dataset for use in training a braai neural network, by
rotating triplets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>candidate_dir</strong> (<em>str</em>) – Directory containing candidate transient tables</p></li>
<li><p><strong>triplet_dir</strong> (<em>str</em>) – Directory containing candidatre triplets (in .npy files)</p></li>
<li><p><strong>outdir</strong> (<em>str</em>) – Directory in which to write the augmented dataset (tables and triplets)</p></li>
<li><p><strong>factor</strong> (<em>{2,3,4}, optional</em>) – Factor by which to augment the dataset (default 4)</p></li>
<li><p><strong>filt</strong> (<em>str, optional</em>) – String filter to use when searching for files by name (default None;
e.g., “2019”)</p></li>
<li><p><strong>real_only</strong> (<em>bool, optional</em>) – Apply the augmentation factor to only candidates with the label 1
(real)? or all candidates (default False)</p></li>
<li><p><strong>*cols</strong> (<em>str, optional</em>) – Names for the columns to take from the tables (default save all
columns for which the first row in the table is populated)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For a directory of N astropy tables of transient candidates in the .fits
format and another directory containing N .npy files, augments this
dataset by rotating each of the three sub-arrays in the triplets in
<cite>factor</cite> increments of 90 degrees, where <cite>factor</cite> can be 2, 3, or 4.</p>
<p>E.g., for 100 tables of candidates, each with 10 candidates, and 100
triplet files, each with 10 triplets, a factor of 3 will produce a new
dataset containing 100 tables, each with 30 candidates, and 100 triplet
files, each with 30 triplets. These new tables and triplets will then be
written to the directory <cite>outdir</cite>.</p>
<p>The purpose of this function is to augment the size of a dataset to be used
in training a braai neural network.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.rb_dataset_utils.augment_dataset_single">
<span class="sig-prename descclassname"><span class="pre">amakihi.rb_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">augment_dataset_single</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tripfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">real_only</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_trips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">cols</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.rb_dataset_utils.augment_dataset_single" title="Permalink to this definition"></a></dt>
<dd><p>Same as <a class="reference internal" href="#amakihi.rb_dataset_utils.augment_dataset" title="amakihi.rb_dataset_utils.augment_dataset"><code class="xref py py-func docutils literal notranslate"><span class="pre">augment_dataset()</span></code></a>, but for a single <cite>tabfile</cite> and
<cite>tripfile</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabfile</strong> (<em>str</em>) – Table of candidate transients (must be a .csv or .fits file)</p></li>
<li><p><strong>tripfile</strong> (<em>str</em>) – .npy file containing triplets corresponding to <cite>tabfile</cite></p></li>
<li><p><strong>factor</strong> (<em>{2,3,4}, optional</em>) – Factor by which to augment the dataset (default 4)</p></li>
<li><p><strong>real_only</strong> (<em>bool, optional</em>) – Apply the augmentation factor to only candidates with the label 1
(real)? or all candidates (default False)</p></li>
<li><p><strong>output_tab</strong> (<em>str, optional</em>) – Name for output table with augmented set of candidate transients
(default set by function)</p></li>
<li><p><strong>output_trips</strong> (<em>str, optional</em>) – Name for output .npy file with augmented set of triplets (default
set by function)</p></li>
<li><p><strong>*cols</strong> (<em>str, optional</em>) – Names for the columns to take from the tables (default save all
columns for which the first row in the table is populated)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For a single table of N candidates and a corresponding .npy file of N
triplets, augments this dataset by rotating each of the three sub-arrays
in the triplets in <cite>factor</cite> increments of 90 degrees, where <cite>factor</cite> can
be 2, 3, or 4.</p>
<p>E.g., for 100 candidates and 100 triplets, a factor of 3 will produce a
new dataset containing 300 candidates 300 triplets. The new table and
triplets will then be written to <cite>output_tab</cite> and <cite>output_trips</cite>,
respectively.</p>
<p>The purpose of this function is to augment the size of a dataset to be
used in training a neural network.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.rb_dataset_utils.augment_SMOTE">
<span class="sig-prename descclassname"><span class="pre">amakihi.rb_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">augment_SMOTE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tripfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">newfrac</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_trips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.rb_dataset_utils.augment_SMOTE" title="Permalink to this definition"></a></dt>
<dd><p>Apply Synthetic Minority Over-sampling Technique (SMOTE) to obtain a
more class-balanced training set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabfile</strong> (<em>str</em>) – Table of candidate transients (must be a .csv or .fits file)</p></li>
<li><p><strong>tripfile</strong> (<em>str</em>) – .npy file containing triplets corresponding to <cite>tabfile</cite></p></li>
<li><p><strong>newfrac</strong> (<em>float, optional</em>) – Fraction (between 0.0, 1.0) of the data which should belong to the
minority class after SMOTE (default 0.5, i.e., augmented dataset
will be half real and half bogus)</p></li>
<li><p><strong>output_trips</strong> (<em>str, optional</em>) – Name for output .npy file with augmented set of triplets (default
set by function)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p><strong>Work in progress: does not yet write an updated table.</strong></p>
<p>See <a class="reference external" href="https://imbalanced-learn.org/stable/references/generated/imblearn.over_sampling.SMOTE.html">https://imbalanced-learn.org/stable/references/generated/imblearn.over_sampling.SMOTE.html</a>
for details and a link to the paper introducing SMOTE.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.rb_dataset_utils.repeaters_pick">
<span class="sig-prename descclassname"><span class="pre">amakihi.rb_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">repeaters_pick</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tripfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_trips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.rb_dataset_utils.repeaters_pick" title="Permalink to this definition"></a></dt>
<dd><p>Pick out sources which are repeated in a given dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabfile</strong> (<em>str</em>) – Table of candidate transients (must be a .csv or .fits file)</p></li>
<li><p><strong>tripfile</strong> (<em>str</em>) – .npy file containing triplets corresponding to <cite>tabfile</cite></p></li>
<li><p><strong>output_tab</strong> (<em>str, optional</em>) – Name for output table with only sources which were repeated (default
set by function)</p></li>
<li><p><strong>output_trips</strong> (<em>str, optional</em>) – Name for output .npy file with only triplets which were repeated
(default set by function)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Given some table of sources, find sources within 0.001 degrees = 3.6
arcseconds of each other and write a table/corresponding triplet file
including only these repeated sources.</p>
<p>E.g., for a table of 1000 candidates where 50 sources were detected
exactly twice, 30 sources detected exactly three times, and 10 sources
detected exactly four times, the final table will contain
50 + 30 + 10 = 90 remaining candidates.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.rb_dataset_utils.repeaters_remove">
<span class="sig-prename descclassname"><span class="pre">amakihi.rb_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">repeaters_remove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tripfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_trips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.rb_dataset_utils.repeaters_remove" title="Permalink to this definition"></a></dt>
<dd><p>Pick out sources which are <strong>not</strong> repeated in a given dataset</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabfile</strong> (<em>str</em>) – Table of candidate transients (must be a .csv or .fits file)</p></li>
<li><p><strong>tripfile</strong> (<em>str</em>) – .npy file containing triplets corresponding to <cite>tabfile</cite></p></li>
<li><p><strong>output_tab</strong> (<em>str, optional</em>) – Name for output table with only sources which were <strong>not</strong> repeated
(default set by function)</p></li>
<li><p><strong>output_trips</strong> (<em>str, optional</em>) – Name for output .npy file with only triplets which were <strong>not</strong>
repeated (default set by function)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Given some table of sources, find sources within 0.001 degrees = 3.6
arcseconds of each other and write a table/corresponding triplet file
which does not include repeats.</p>
<p>E.g., for a table of 1000 candidates where 50 sources were detected
exactly twice, 30 sources detected exactly three times, and 10 sources
detected exactly four times, the final table will contain
1000 - (2-1)*50 - (3-1)*30 - (4-1)*10 = 860 remaining candidates.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.rb_dataset_utils.triplets_normalize">
<span class="sig-prename descclassname"><span class="pre">amakihi.rb_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">triplets_normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tripfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_trips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.rb_dataset_utils.triplets_normalize" title="Permalink to this definition"></a></dt>
<dd><p>Normalize triplets for training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tripfile</strong> (<em>str</em>) – .npy file containing triplets</p></li>
<li><p><strong>output_trips</strong> (<em>str, optional</em>) – Name for output .npy file with normalized set of triplets (default
set by function)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of normalized triplets</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For an array of N triplets with shape <cite>(N, 3, X, Y)</cite>, normalizes each
science, reference and difference image <strong>independently</strong> using L2
normalization. Should be called <strong>BEFORE</strong> rearranging the triplets into
shape <cite>(N, X, Y, 3)</cite> with <a class="reference internal" href="#amakihi.rb_dataset_utils.triplets_rearrange" title="amakihi.rb_dataset_utils.triplets_rearrange"><code class="xref py py-func docutils literal notranslate"><span class="pre">triplets_rearrange()</span></code></a>.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.rb_dataset_utils.triplets_rearrange">
<span class="sig-prename descclassname"><span class="pre">amakihi.rb_dataset_utils.</span></span><span class="sig-name descname"><span class="pre">triplets_rearrange</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tripfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_trips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.rb_dataset_utils.triplets_rearrange" title="Permalink to this definition"></a></dt>
<dd><p>Re-arrange triplets to a shape compatible with bogus-real adversarial
artifiical intelligence (braai).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tripfile</strong> (<em>str</em>) – .npy file containing triplets</p></li>
<li><p><strong>output_trips</strong> (<em>str, optional</em>) – Name for output .npy file with re-arranged set of triplets (default
set by function)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of re-arranged triplets</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>For an array of N triplets with shape <cite>(N, 3, X, Y)</cite>, rearranges the array
to have shape <cite>(N, X, Y, 3)</cite>. This is the required format for training the
braai. Should be used as the <strong>FINAL</strong> step of pre-processing, after
merging, augmenting, normalizing, etc. Calling this function on several
triplet files and then trying to merge, augment, etc. will <strong>NOT</strong> work.</p>
</dd></dl>

</section>
<section id="module-amakihi.rb_model_utils">
<span id="amakihi-rb-model-utils-module"></span><h2>amakihi.rb_model_utils module<a class="headerlink" href="#module-amakihi.rb_model_utils" title="Permalink to this heading"></a></h2>
<p>Utility functions for interacting with (real-bogus) Keras models: writing,
reading, and applying to candidate transients.</p>
<dl class="py function">
<dt class="sig sig-object py" id="amakihi.rb_model_utils.write_model">
<span class="sig-prename descclassname"><span class="pre">amakihi.rb_model_utils.</span></span><span class="sig-name descname"><span class="pre">write_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_json</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_weights</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.rb_model_utils.write_model" title="Permalink to this definition"></a></dt>
<dd><p>Save a Keras model by writing the architecture to a .json file and
writing the weights to a .h5 file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>tf.keras.model</em>) – Keras model to save</p></li>
<li><p><strong>output_json</strong> (<em>str, optional</em>) – Name for .json file containing the architecture (default ‘model.json’)</p></li>
<li><p><strong>output_weights</strong> (<em>str, optional</em>) – Name for .h5 file containing the model weights (default ‘model.h5’)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.rb_model_utils.load_model">
<span class="sig-prename descclassname"><span class="pre">amakihi.rb_model_utils.</span></span><span class="sig-name descname"><span class="pre">load_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_json</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_weights</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.rb_model_utils.load_model" title="Permalink to this definition"></a></dt>
<dd><p>Load in a Keras model from the architecture (.json file) and weights
(.h5 file)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_json</strong> (<em>str</em>) – .json file containing the architecture</p></li>
<li><p><strong>input_weights</strong> (<em>str</em>) – .h5 file containing the model weights</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Keras model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tf.keras.model</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.rb_model_utils.use_model">
<span class="sig-prename descclassname"><span class="pre">amakihi.rb_model_utils.</span></span><span class="sig-name descname"><span class="pre">use_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tripfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_json</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rb_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.rb_model_utils.use_model" title="Permalink to this definition"></a></dt>
<dd><p>Apply some trained model to a set of candidate transients contained in
a table and array of triplets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabfile</strong> (<em>str</em>) – Table of candidate transients (must be a .csv or .fits file)</p></li>
<li><p><strong>tripfile</strong> (<em>str</em>) – .npy file containing triplets corresponding to <cite>tabfile</cite></p></li>
<li><p><strong>input_json</strong> (<em>str</em>) – .json file containing the architecture</p></li>
<li><p><strong>input_weights</strong> (<em>str</em>) – .h5 file containing the model weights</p></li>
<li><p><strong>rb_thresh</strong> (<em>float, array_like, optional</em>) – RB score(s) to use as threshold for a source to be considered real,
between 0.0 and 1.0 (default 0.5 –&gt; sources with RB score above 0.5
considered real; only used for printing the aggregate results; can
provide an array to print results for multiple scores)</p></li>
<li><p><strong>output_tab</strong> (<em>str, optional</em>) – Name for output table with their RB scores (default set by function)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array of RB scores for each triplet</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Input triplets must already be normalized
(<code class="xref py py-func docutils literal notranslate"><span class="pre">rb_dataset_utils.triplets_normalize()</span></code>) and re-arranged
(<code class="xref py py-func docutils literal notranslate"><span class="pre">rb_dataset_utils.triplets_rearrange()</span></code>) to be compatible with
braai.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.rb_model_utils.write_reals">
<span class="sig-prename descclassname"><span class="pre">amakihi.rb_model_utils.</span></span><span class="sig-name descname"><span class="pre">write_reals</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tripfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rb_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_trips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.rb_model_utils.write_reals" title="Permalink to this definition"></a></dt>
<dd><p>Given a table and triplets which have been labelled by some model
predictions, write only the sources with scores <strong>ABOVE</strong> <cite>rb_thresh</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabfile</strong> (<em>str</em>) – Table of candidate transients (must be a .csv or .fits file)</p></li>
<li><p><strong>tripfile</strong> (<em>str</em>) – .npy file containing triplets corresponding to <cite>tabfile</cite></p></li>
<li><p><strong>rb_thresh</strong> (<em>float, array_like, optional</em>) – RB score(s) to use as threshold for a source to be considered real,
between 0.0 and 1.0 (default 0.5 –&gt; sources with RB score above 0.5
will be considered real)</p></li>
<li><p><strong>output_tab</strong> (<em>str, optional</em>) – Name for output table with their RB scores (default set by function)</p></li>
<li><p><strong>output_trips</strong> (<em>str, optional</em>) – Name for output .npy file with triplets labeled as real (default set
by function)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.rb_model_utils.write_bogus">
<span class="sig-prename descclassname"><span class="pre">amakihi.rb_model_utils.</span></span><span class="sig-name descname"><span class="pre">write_bogus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">tabfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tripfile</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rb_thresh</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_tab</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_trips</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.rb_model_utils.write_bogus" title="Permalink to this definition"></a></dt>
<dd><p>Given a table and triplets which have been labelled by some model
predictions, write only the sources with scores <strong>BELOW</strong> <cite>rb_thresh</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabfile</strong> (<em>str</em>) – Table of candidate transients (must be a .csv or .fits file)</p></li>
<li><p><strong>tripfile</strong> (<em>str</em>) – .npy file containing triplets corresponding to <cite>tabfile</cite></p></li>
<li><p><strong>rb_thresh</strong> (<em>float, array_like, optional</em>) – RB score(s) to use as threshold for a source to be considered real,
between 0.0 and 1.0 (default 0.5 –&gt; sources with RB score below 0.5
will be considered bogus)</p></li>
<li><p><strong>output_tab</strong> (<em>str, optional</em>) – Name for output table with their RB scores (default set by function)</p></li>
<li><p><strong>output_trips</strong> (<em>str, optional</em>) – Name for output .npy file with triplets labeled as bogus (default set
by function)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.rb_model_utils.vgg6">
<span class="sig-prename descclassname"><span class="pre">amakihi.rb_model_utils.</span></span><span class="sig-name descname"><span class="pre">vgg6</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(63,</span> <span class="pre">63,</span> <span class="pre">3)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.rb_model_utils.vgg6" title="Permalink to this definition"></a></dt>
<dd><p>VGG6 convolutional neural network.</p>
<p class="rubric">Notes</p>
<p>Notes taken from braai:</p>
<p>“VGG-like sequential model (VGG6; this architecture was first proposed by
the Visual Geometry Group of the Department of Engineering Science,
University of Oxford, UK)</p>
<p>The model has six layers with trainable parameters: four convolutional and
two fully-connected. The first two convolutional layers use 16 3x3 pixel
filters each while in the second pair, 32 3x3 pixel filters are used. To
prevent over-fitting, a dropout rate of 0.25 is applied after each max-
pooling layer and a dropout rate of 0.5 is applied after the second fully-
connected layer. ReLU activation functions (Rectified Linear Unit – a
function defined as the positive part of its argument) are used for all
five hidden trainable layers; a sigmoid activation function is used for
the output layer.”</p>
</dd></dl>

</section>
<section id="module-amakihi.templates">
<span id="amakihi-templates-module"></span><h2>amakihi.templates module<a class="headerlink" href="#module-amakihi.templates" title="Permalink to this heading"></a></h2>
<p>This module enables downloading reference images (i.e. templates) to be used in
image differencing. Templates can be downloaded from each survey in the
corresponding filters:</p>
<ul class="simple">
<li><p><strong>Pan-STARRS 1 (PS1)</strong> <span class="math notranslate nohighlight">\(3\pi\)</span> <strong>survey:</strong> <em>g, r, i, z, y</em></p></li>
<li><p><strong>Dark Energy Camera Legacy Survey (DECaLS):</strong> <em>g, r, z</em></p></li>
<li><p><strong>Canada-France Imaging Survey (CFIS):</strong> <em>u, r</em></p></li>
<li><p><strong>2-Micron All-Sky Survey (2MASS):</strong> <em>J, H, K</em></p></li>
</ul>
<p>Note that CFIS requires a Canadian Astronomy Data Centre (CADC) username and
password to verify that you have access to this data.</p>
<p><strong>TO-DO:</strong></p>
<ul class="simple">
<li><p>Why do some of the <cite>download_x_template()</cite> functions not take an <cite>output</cite> arg
while others do?</p></li>
</ul>
<dl class="py exception">
<dt class="sig sig-object py" id="amakihi.templates.InvalidBandError">
<em class="property"><span class="pre">exception</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">amakihi.templates.</span></span><span class="sig-name descname"><span class="pre">InvalidBandError</span></span><a class="headerlink" href="#amakihi.templates.InvalidBandError" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Raise this error when a template is requested in a single band/multiple
bands and none of the inputs band(s) are available for the requested
survey.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.templates.download_PS1_template">
<span class="sig-prename descclassname"><span class="pre">amakihi.templates.</span></span><span class="sig-name descname"><span class="pre">download_PS1_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'grizy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.templates.download_PS1_template" title="Permalink to this definition"></a></dt>
<dd><p>Downloads the relevant template image(s) at the input RA, Dec from the
Panoramic Survey Telescope and Rapid Response System (Pan-STARRS) archive
(specifically, the Pan-STARRS 1 (PS1) <span class="math notranslate nohighlight">\(3\pi\)</span> survey).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – RA and Dec of interest</p></li>
<li><p><strong>size</strong> (<em>int, optional</em>) – Size of the cutout image in pixels (1 pix == 0.25” in PS1; default
2400)</p></li>
<li><p><strong>bands</strong> (<em>str, optional</em>) – Photometric band(s) of choice (default “grizy” –&gt; g-, r-, i-, z-, and
y-band; options are “g”, “r”, “i”, “z”, “y” or any combination of them)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Output filename(s) for the downloaded template(s) (default set
automatically)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of astropy HDUList object(s) for the downloaded template image(s)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of <cite>astropy.io.fits.hdu.hdulist.HDUList</cite> objects</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.templates.download_DECaLS_template">
<span class="sig-prename descclassname"><span class="pre">amakihi.templates.</span></span><span class="sig-name descname"><span class="pre">download_DECaLS_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">512</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.262</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'grz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.templates.download_DECaLS_template" title="Permalink to this definition"></a></dt>
<dd><p>Downloads the relevant Dark Energy Camera Legacy Survey (DECaLS)
template image(s) at the input RA, Dec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – RA and Dec of interest</p></li>
<li><p><strong>size</strong> (<em>int, optional</em>) – Size of the cutout image in pixels (1 pix == 0.262” in native DECam
resolution, but pixel scale can be changed; default 512)</p></li>
<li><p><strong>pixscale</strong> (<em>float, optional</em>) – Pixel scale of the images in arcsec per pixel, (default 0.262”/pix,
which is the native DECam resolution)</p></li>
<li><p><strong>bands</strong> (<em>str, optional</em>) – Photometric band(s) of choice (default “grz” –&gt; g-, r-, and z-band;
options are “g”, “r”, “z”, or any combination of them)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Output filename(s) for the downloaded template(s) (default set
automatically)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of astropy HDUList object(s) for the downloaded template image(s)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of <cite>astropy.io.fits.hdu.hdulist.HDUList</cite> objects</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.templates.download_CFIS_template">
<span class="sig-prename descclassname"><span class="pre">amakihi.templates.</span></span><span class="sig-name descname"><span class="pre">download_CFIS_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auth_user</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">auth_pass</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1600</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ur'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.templates.download_CFIS_template" title="Permalink to this definition"></a></dt>
<dd><p>Downloads the relevant Canada France Imaging Survey (CFIS) template
image(s) at the input RA, Dec. Requires a Canadian Astronomy Data Centre
(CADC) username and password.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – RA and Dec of interest</p></li>
<li><p><strong>auth_user, auth_pass</strong> (<em>str</em>) – CADC username and password</p></li>
<li><p><strong>size</strong> (<em>float, optional</em>) – Size of the cutout image in pixels (1 pix == 0.185” in CFIS; default
1600)</p></li>
<li><p><strong>bands</strong> (<em>str, optional</em>) – Photometric band(s) of choice (default “ur” –&gt; u- and r-band;
options are “u”, “r”, “ur”)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of astropy HDUList object(s) for the downloaded template image(s)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of <cite>astropy.io.fits.hdu.hdulist.HDUList</cite> objects</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.templates.download_2MASS_template">
<span class="sig-prename descclassname"><span class="pre">amakihi.templates.</span></span><span class="sig-name descname"><span class="pre">download_2MASS_template</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">150</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bands</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'A'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.templates.download_2MASS_template" title="Permalink to this definition"></a></dt>
<dd><p>Downloads the relevant 2MASS template image(s) at the input RA, Dec.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ra, dec</strong> (<em>float</em>) – RA and Dec of interest</p></li>
<li><p><strong>size</strong> (<em>float, optional</em>) – Size of the cutout image in pixels (1 pix == 4.0” in 2MASS; default
150)</p></li>
<li><p><strong>bands</strong> (<em>str, optional</em>) – Photometric band(s) of choice (default “A” –&gt; all; options are “A”,
“J”, “H”, “K” - see notes for details)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List of astropy HDUList object(s) for the downloaded template image(s)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list of <cite>astropy.io.fits.hdu.hdulist.HDUList</cite> objects</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Options for bands are “A” –&gt;  all, <strong>OR</strong> “J” for only J-band, <strong>OR</strong> “H”
for only H-band, <strong>OR</strong> “K” for only K-band. Combinations such as e.g. “JH”
are not allowed.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.templates.get_templates">
<span class="sig-prename descclassname"><span class="pre">amakihi.templates.</span></span><span class="sig-name descname"><span class="pre">get_templates</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">images</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">survey</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PS1'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.templates.get_templates" title="Permalink to this definition"></a></dt>
<dd><p>For a directory full of images, downloads a corresponding template from
the requested survey, if possible. Currently only implemented for PS1 and
CFIS.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>images</strong> (<em>str or array_like</em>) – Directory containing image file(s) for which to download a template
<strong>OR</strong> a list of individual filenames</p></li>
<li><p><strong>survey</strong> (<em>{‘PS1’, ‘CFIS’}, optional</em>) – Survey of interest (default ‘PS1’)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Output filename(s) for the downloaded template(s) (default set
automatically)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-amakihi.transient">
<span id="amakihi-transient-module"></span><h2>amakihi.transient module<a class="headerlink" href="#module-amakihi.transient" title="Permalink to this heading"></a></h2>
<p>Transient detection, vetting, and converting candidate transients to
“triplets”. This represents the final step in an image differencing and
transient detection pipeline. You can then use your favourite machine learning
algorithm to further vet the candidates. I use bogus-real adversarial
artificial intelligence <code class="docutils literal notranslate"><span class="pre">braai</span></code> (<a class="reference external" href="https://github.com/dmitryduev/braai">https://github.com/dmitryduev/braai</a>), which
is an example of a “real-bogus” classifier.</p>
<dl class="py function">
<dt class="sig sig-object py" id="amakihi.transient.transient_detect">
<span class="sig-prename descclassname"><span class="pre">amakihi.transient.</span></span><span class="sig-name descname"><span class="pre">transient_detect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sub_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">og_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask_file</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixelmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dipole_width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dipole_fratio</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">etamax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">areamax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">300.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsource_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toi_sep_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">toi_sep_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_distributions</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_rejections</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plots</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['zoom</span> <span class="pre">og',</span> <span class="pre">'zoom</span> <span class="pre">ref',</span> <span class="pre">'zoom</span> <span class="pre">diff']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixcoords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sub_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'asinh'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">og_scale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'asinh'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stampsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crosshair_og</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#fe019a'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">crosshair_sub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'#5d06e9'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.transient.transient_detect" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sub_file</strong> (<em>str</em>) – Difference image fits filename</p></li>
<li><p><strong>og_file</strong> (<em>str</em>) – Original science image fits filename (does not need to be background-
subtracted)</p></li>
<li><p><strong>ref_file</strong> (<em>str</em>) – Reference image fits filename (does not need to be background-
subtracted)</p></li>
<li><p><strong>mask_file</strong> (<em>str, optional</em>) – Mask image fits filename (default None)</p></li>
<li><p><strong>thresh_sigma</strong> (<em>float, optional</em>) – Sigma threshold for source detection with image segmentation (default
5.0)</p></li>
<li><p><strong>pixelmin</strong> (<em>float, optional</em>) – <em>Minimum</em> pixel area of an isophote to be considered a potential
transient (default 20)</p></li>
<li><p><strong>dipole_width</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed width (in arcsec) for a source to be considered a
potential dipole residual from image differencing (default 2.0)</p></li>
<li><p><strong>dipole_fratio</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed ratio of brightness between the brighter and dimmer
of the two “poles” for a source to be a considered a potential dipole
residual from image differencing (default 5.0)</p></li>
<li><p><strong>etamax</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed elongation for an isophote to be considered a
potential transient (default 1.8)</p></li>
<li><p><strong>areamax</strong> (<em>float, optional</em>) – <em>Maximum</em> allowed area (in square pixels) for an isophote to be
considered a potential transient (default 300.0)</p></li>
<li><p><strong>nsource_max</strong> (<em>int, optional</em>) – If more than <cite>nsource_max</cite> sources pass all vetting, the image
registration was probably of poor quality, and so the function exits
(default 50)</p></li>
<li><p><strong>toi</strong> (<em>array_like, optional</em>) – [ra, dec] for some target of interest (e.g. a candidate host galaxy)
such that only transients within some distance of this target are
considered (see <cite>toi_sep_min</cite>, <cite>toi_sep_max</cite>; default None)</p></li>
<li><p><strong>toi_sep_min, toi_sep_max</strong> (<em>float, optional</em>) – <em>Minimum</em> and <em>maximum</em> allowed separation from the <cite>toi</cite> for a source
to be considered valid (default None)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Whether to write the table of candidate sources (default True)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output table (default
<cite>og_file.replace(“.fits”, “_candidates.fits”)</cite>)</p></li>
<li><p><strong>plot_distributions</strong> (<em>bool, optional</em>) – Whether to plot informative distributions of the elongation and area of
the candidate transients (default False)</p></li>
<li><p><strong>plot_rejections</strong> (<em>bool, optional</em>) – Whether to plot a version of the difference image where accepted/
rejected sources are labelled with markers (default False)</p></li>
<li><p><strong>plots</strong> (<em>array_like, optional</em>) – Array indicating which plots to produce, where options are “full”,
“zoom og”, “zoom ref”, “zoom diff” (default
[“zoom og”, “zoom ref”, “zoom diff”], see notes)</p></li>
<li><p><strong>pixcoords</strong> (<em>bool, optional</em>) – Whether to use the <em>pixel</em> coordinates of the transient(s) when
plotting rather than the WCS coordinates (default False)</p></li>
<li><p><strong>sub_scale</strong> (<em>{“asinh”, “linear”, “log”}, optional</em>) – Scale to use for the difference image (default “asinh”)</p></li>
<li><p><strong>og_scale</strong> (<em>{“asinh”, “linear”, “log”}, optional</em>) – Scale to use for the science/reference images (default “asinh”)</p></li>
<li><p><strong>stampsize</strong> (<em>float, optional</em>) – Pixel size of the box to crop around the transient(s) (default 200.0)</p></li>
<li><p><strong>crosshair_og</strong> (<em>str, optional</em>) – Color for the crosshair in the science/reference image (default
“#fe019a” –&gt; ~ hot pink)</p></li>
<li><p><strong>crosshair_sub</strong> (<em>str, optional</em>) – Color for the crosshair in the difference image (default
“#5d06e9” –&gt; ~ purple-blue)</p></li>
<li><p><strong>title_append</strong> (<em>str, optional</em>) – A “title” to include in all plots’ titles <strong>and</strong> the filenames of all
saved figures (default None)</p></li>
<li><p><strong>plotdir</strong> (<em>str, optional</em>) – Name of directory in which to save plots (default None, in which case
the stamps will be saved in the directory containing the corresponding
fits image)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An astropy table containing vetted sources with their properties
(coordinates, area, elongation, separation from some target of
interest, etc.)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>astropy.table.Table</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Finds sources with flux &gt; <cite>thresh_sigma</cite> * std, where std is the standard
deviation of the good pixels in the subtracted image. Sources must also be
made up of at least <cite>pixelmin</cite> pixels. From these, selects sources within
some elongation limit <cite>etamax</cite> to try to prevent obvious residuals from
being detected as sources. Also vets according to some maximum allowed
pixel area <cite>areamax</cite>. Finally, if more than <cite>nsource_max</cite> sourcs remain,
the image registration was probably faulty, and so the function terminates.</p>
<p>Optionally plots informative figures showing the elongation distribution
and area distribution of all sources (included those which are rejected).</p>
<p>For each candidate transient source, also optionally plots the full
subtracted image and “postage stamps” of the transient on the original
science image, reference image and/or subtracted image. When indicating
which plots to produce via the <cite>plots</cite> argument (an <cite>array_like</cite>), the
options are:</p>
<ol class="arabic simple">
<li><p>“full” - the full-frame subtracted image</p></li>
<li><p>“zoom og” - postage stamp of the original science image</p></li>
<li><p>“zoom ref” - postage stamp of the original reference image</p></li>
<li><p>“zoom diff” - postage stamp of the subtracted image</p></li>
</ol>
<p>If performing any of this plotting, it is recommended to use the pixel
coordinates (i.e. set <cite>pixcoords = True</cite>) when the quality of the
astrometric solution for the science or reference images cannot be assured.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.transient.transient_triplets">
<span class="sig-prename descclassname"><span class="pre">amakihi.transient.</span></span><span class="sig-name descname"><span class="pre">transient_triplets</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sub_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">og_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tbl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pixcoords</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cropmode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'extend'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wide</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmap</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bone'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_append</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plotdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.transient.transient_triplets" title="Permalink to this definition"></a></dt>
<dd><p>From some detected and preliminarily vetted transients, produce and
optionally write the final set of triplets.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sub_file</strong> (<em>str</em>) – Difference image fits filename</p></li>
<li><p><strong>og_file</strong> (<em>str</em>) – Original science image fits filename (does not need to be background-
subtracted)</p></li>
<li><p><strong>ref_file</strong> (<em>str</em>) – Reference image fits filename (does not need to be background-
subtracted)</p></li>
<li><p><strong>tbl</strong> (<em>str or astropy.table.Table</em>) – Table of candidate transient source(s) found with <cite>transient_detect()</cite>
or some other tool (can be a filename or the table itself)</p></li>
<li><p><strong>pixcoords</strong> (<em>bool, optional</em>) – Whether to use the <em>pixel</em> coordinates of the transient(s) when
plotting rather than the WCS coordinates (default False; see notes)</p></li>
<li><p><strong>size</strong> (<em>float, optional</em>) – Pixel size of the box to crop around the transient(s) (default 200.0)</p></li>
<li><p><strong>cropmode</strong> (<em>{“extend”, “truncate”}, optional</em>) – Mode to apply when cropping around the transient (default “extend”)</p></li>
<li><p><strong>write</strong> (<em>bool, optional</em>) – Whether to write the produced triplets to a .npy file (default True)</p></li>
<li><p><strong>output</strong> (<em>str, optional</em>) – Name for output .npy file (default
<cite>og_file.replace(“.fits”, “_candidates_triplets.npy”)</cite>)</p></li>
<li><p><strong>plot</strong> (<em>bool, optional</em>) – Whether to plot <strong>all</strong> of the triplets (default False)</p></li>
<li><p><strong>wide</strong> (<em>bool, optional</em>) – Whether to plot each triplet as 1 row, 3 columns (<cite>wide == True</cite>) or 3
rows, 1 column (<cite>wide == False</cite>) (default True)</p></li>
<li><p><strong>cmap</strong> (<em>str, optional</em>) – Colormap to apply to all images in the triplets (default “bone”)</p></li>
<li><p><strong>title_append</strong> (<em>str, optional</em>) – A “title” to include in all plots’ titles <strong>and</strong> filenames (default
None)</p></li>
<li><p><strong>plotdir</strong> (<em>str, optional</em>) – Directory in which to save the plots (default is the directory of
<cite>og_file</cite>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Array with shape <cite>(N, 3, size, size)</cite>, where <cite>N</cite> is the number of rows
in the input <cite>tbl</cite> (i.e., number of candidate transients), <cite>size</cite> is
the dimension of the box used when cropping around candidates, and the
3 sub-arrays represent cropped sections of the science, reference,
and difference image, in that order</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>If <cite>pixcoords == False</cite>, <cite>tbl</cite> must contain <em>at least</em> the columns <em>ra</em> and
<em>dec</em>. If true, must contain <em>at least</em> the columns <em>xcentroid</em> and
<em>ycentroid</em>. It is recommended to use the pixel coordinates (i.e. set
<cite>pixcoords = True</cite>) when the quality of the astrometric solution for the
science or reference images cannot be assured.</p>
<p>When indicating which plots to produce via the <cite>plots</cite> argument (an
<cite>array_like</cite>), the options are:</p>
<ol class="arabic simple">
<li><p>“full” - the full-frame subtracted image</p></li>
<li><p>“zoom og” - postage stamp of the original science image</p></li>
<li><p>“zoom ref” - postage stamp of the original reference image</p></li>
<li><p>“zoom diff” - postage stamp of the subtracted image</p></li>
</ol>
<p>From a table of candidate transients and the corresponding difference,
science, and reference images, builds a triplet: three “postage stamps”
around the candidate showing the science image, reference image, and
difference image. Optionally writes the triplet to a .npy file.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="amakihi.transient.im_contains">
<span class="sig-prename descclassname"><span class="pre">amakihi.transient.</span></span><span class="sig-name descname"><span class="pre">im_contains</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">im_file</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dec</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclusion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#amakihi.transient.im_contains" title="Permalink to this definition"></a></dt>
<dd><p>Check if some coordinates [ra, dec] lie within the bounds of an image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>im_file</strong> (<em>str</em>) – Image of interest</p></li>
<li><p><strong>ra, dec</strong> (<em>float</em>) – Right Ascension, Declination of a single source</p></li>
<li><p><strong>exclusion</strong> (<em>float, optional</em>) – Fraction of edge pixels to ignore (default None; see examples)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Whether the coordinates are in the image</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>For a 1000 x 1000 image, to look for a source at (ra, dec) = (180.0, 30.0)
and ignore the outermost 5% of edge pixels:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">im_contains</span><span class="p">(</span><span class="s2">&quot;foo.fits&quot;</span><span class="p">,</span> <span class="mf">180.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)</span>
</pre></div>
</div>
<p>To <strong>not</strong> ignore any pixels (i.e. consider a set of coordinates to be
contained even if on the edgemost pixels):</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">im_contains</span><span class="p">(</span><span class="s2">&quot;foo.fits&quot;</span><span class="p">,</span> <span class="mf">180.0</span><span class="p">,</span> <span class="mf">30.0</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>
<section id="module-amakihi">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-amakihi" title="Permalink to this heading"></a></h2>
<p>Top-level package for amakihi.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="amakihi" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Nicholas Vieira.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>